ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"TMAG5170.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.TransmitData,"ax",%progbits
  20              		.align	1
  21              		.global	TransmitData
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	TransmitData:
  27              	.LVL0:
  28              	.LFB135:
  29              		.file 1 "Core/Src/TMAG5170.c"
   1:Core/Src/TMAG5170.c **** /*
   2:Core/Src/TMAG5170.c ****  *   TMAG51170.c
   3:Core/Src/TMAG5170.c ****  *
   4:Core/Src/TMAG5170.c ****  *   Created on: 21.10.2022
   5:Core/Src/TMAG5170.c ****  *       Author: JS
   6:Core/Src/TMAG5170.c ****  *
   7:Core/Src/TMAG5170.c ****  */
   8:Core/Src/TMAG5170.c **** 
   9:Core/Src/TMAG5170.c **** #include "tmag5170.h"
  10:Core/Src/TMAG5170.c **** #include <inttypes.h>
  11:Core/Src/TMAG5170.c **** #include <string.h>
  12:Core/Src/TMAG5170.c **** #include <spi.h>
  13:Core/Src/TMAG5170.c **** #include <usart.h>
  14:Core/Src/TMAG5170.c **** #include <stdio.h>
  15:Core/Src/TMAG5170.c **** #include <stdlib.h>
  16:Core/Src/TMAG5170.c **** 
  17:Core/Src/TMAG5170.c **** static TMAG5170_DEVICE_CONFIG_settings_t DeviceConfigSettings;
  18:Core/Src/TMAG5170.c **** // static TMAG5170_DEVICE_CONFIG_settings_t results;
  19:Core/Src/TMAG5170.c **** static TMAG5170_reg_addr_t register_address;
  20:Core/Src/TMAG5170.c **** 
  21:Core/Src/TMAG5170.c **** static TMAG5170_SENSOR_CONFIG_settings_t SensorConfigSettings;
  22:Core/Src/TMAG5170.c **** 
  23:Core/Src/TMAG5170.c **** static TMAG5170_SYSTEM_CONFIG_settings_t SystemConfigSettings;
  24:Core/Src/TMAG5170.c **** 
  25:Core/Src/TMAG5170.c **** static TMAG5170_ALERT_CONFIG_settings_t AlertConfigSettings;
  26:Core/Src/TMAG5170.c **** 
  27:Core/Src/TMAG5170.c **** 
  28:Core/Src/TMAG5170.c **** 
  29:Core/Src/TMAG5170.c **** 
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 2


  30:Core/Src/TMAG5170.c **** 
  31:Core/Src/TMAG5170.c **** 
  32:Core/Src/TMAG5170.c **** void TransmitData(uint8_t address, uint8_t dataTx[2], uint8_t crc)
  33:Core/Src/TMAG5170.c **** {
  30              		.loc 1 33 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 8
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 33 1 is_stmt 0 view .LVU1
  35 0000 70B5     		push	{r4, r5, r6, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 16
  38              		.cfi_offset 4, -16
  39              		.cfi_offset 5, -12
  40              		.cfi_offset 6, -8
  41              		.cfi_offset 14, -4
  42 0002 82B0     		sub	sp, sp, #8
  43              	.LCFI1:
  44              		.cfi_def_cfa_offset 24
  45 0004 0D46     		mov	r5, r1
  46 0006 8DF80700 		strb	r0, [sp, #7]
  47 000a 8DF80620 		strb	r2, [sp, #6]
  34:Core/Src/TMAG5170.c ****   // zapisanie '0' na pierwszym miejscu aby dane były zapisane w sensorze
  35:Core/Src/TMAG5170.c ****   address |= 0b0 << 7;
  48              		.loc 1 35 3 is_stmt 1 view .LVU2
  36:Core/Src/TMAG5170.c ****   
  37:Core/Src/TMAG5170.c ****   // zmiana stanu pinow CS na 0 w celu zainicjiowania urzadzen, do obu sensorow sa wprowadzane te s
  38:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
  49              		.loc 1 38 3 view .LVU3
  50 000e 124E     		ldr	r6, .L3
  51 0010 0022     		movs	r2, #0
  52              	.LVL1:
  53              		.loc 1 38 3 is_stmt 0 view .LVU4
  54 0012 1021     		movs	r1, #16
  55              	.LVL2:
  56              		.loc 1 38 3 view .LVU5
  57 0014 3046     		mov	r0, r6
  58              	.LVL3:
  59              		.loc 1 38 3 view .LVU6
  60 0016 FFF7FEFF 		bl	HAL_GPIO_WritePin
  61              	.LVL4:
  39:Core/Src/TMAG5170.c ****   //HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 0);
  40:Core/Src/TMAG5170.c **** 
  41:Core/Src/TMAG5170.c ****   // rozpoczynamy transmisje od adresu, nastepnie 2 bajty danych oraz crc
  42:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &address, 1, HAL_MAX_DELAY);
  62              		.loc 1 42 3 is_stmt 1 view .LVU7
  63 001a 104C     		ldr	r4, .L3+4
  64 001c 4FF0FF33 		mov	r3, #-1
  65 0020 0122     		movs	r2, #1
  66 0022 0DF10701 		add	r1, sp, #7
  67 0026 2046     		mov	r0, r4
  68 0028 FFF7FEFF 		bl	HAL_SPI_Transmit
  69              	.LVL5:
  43:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, dataTx, 2, HAL_MAX_DELAY);
  70              		.loc 1 43 3 view .LVU8
  71 002c 4FF0FF33 		mov	r3, #-1
  72 0030 0222     		movs	r2, #2
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 3


  73 0032 2946     		mov	r1, r5
  74 0034 2046     		mov	r0, r4
  75 0036 FFF7FEFF 		bl	HAL_SPI_Transmit
  76              	.LVL6:
  44:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &crc, 1, HAL_MAX_DELAY);
  77              		.loc 1 44 3 view .LVU9
  78 003a 4FF0FF33 		mov	r3, #-1
  79 003e 0122     		movs	r2, #1
  80 0040 0DF10601 		add	r1, sp, #6
  81 0044 2046     		mov	r0, r4
  82 0046 FFF7FEFF 		bl	HAL_SPI_Transmit
  83              	.LVL7:
  45:Core/Src/TMAG5170.c ****   
  46:Core/Src/TMAG5170.c ****   // konczymy inicjalizacje po przez zmiane stanow pinow CS na 1
  47:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
  84              		.loc 1 47 3 view .LVU10
  85 004a 0122     		movs	r2, #1
  86 004c 1021     		movs	r1, #16
  87 004e 3046     		mov	r0, r6
  88 0050 FFF7FEFF 		bl	HAL_GPIO_WritePin
  89              	.LVL8:
  48:Core/Src/TMAG5170.c ****   //HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
  49:Core/Src/TMAG5170.c **** 
  50:Core/Src/TMAG5170.c **** }
  90              		.loc 1 50 1 is_stmt 0 view .LVU11
  91 0054 02B0     		add	sp, sp, #8
  92              	.LCFI2:
  93              		.cfi_def_cfa_offset 16
  94              		@ sp needed
  95 0056 70BD     		pop	{r4, r5, r6, pc}
  96              	.LVL9:
  97              	.L4:
  98              		.loc 1 50 1 view .LVU12
  99              		.align	2
 100              	.L3:
 101 0058 00040048 		.word	1207960576
 102 005c 00000000 		.word	hspi1
 103              		.cfi_endproc
 104              	.LFE135:
 106              		.section	.text.TMAG5170_dev_conf_settings,"ax",%progbits
 107              		.align	1
 108              		.global	TMAG5170_dev_conf_settings
 109              		.syntax unified
 110              		.thumb
 111              		.thumb_func
 113              	TMAG5170_dev_conf_settings:
 114              	.LVL10:
 115              	.LFB136:
  51:Core/Src/TMAG5170.c **** 
  52:Core/Src/TMAG5170.c **** 
  53:Core/Src/TMAG5170.c **** 
  54:Core/Src/TMAG5170.c **** TMAG5170_return_code_t TMAG5170_dev_conf_settings(TMAG5170_DEVICE_CONFIG_settings_t *new_settings)
  55:Core/Src/TMAG5170.c **** {
 116              		.loc 1 55 1 is_stmt 1 view -0
 117              		.cfi_startproc
 118              		@ args = 0, pretend = 0, frame = 8
 119              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 4


 120              		.loc 1 55 1 is_stmt 0 view .LVU14
 121 0000 00B5     		push	{lr}
 122              	.LCFI3:
 123              		.cfi_def_cfa_offset 4
 124              		.cfi_offset 14, -4
 125 0002 83B0     		sub	sp, sp, #12
 126              	.LCFI4:
 127              		.cfi_def_cfa_offset 16
 128 0004 0346     		mov	r3, r0
  56:Core/Src/TMAG5170.c ****   
  57:Core/Src/TMAG5170.c ****   uint8_t register_address = TMAG5170_DEVICE_CONFIG_REG;
 129              		.loc 1 57 3 is_stmt 1 view .LVU15
 130              	.LVL11:
  58:Core/Src/TMAG5170.c ****   TMAG5170_return_code_t ret = TMAG5170_RET_OK;
 131              		.loc 1 58 3 view .LVU16
  59:Core/Src/TMAG5170.c **** 
  60:Core/Src/TMAG5170.c ****   // copy bytes from settings to new_settings
  61:Core/Src/TMAG5170.c ****   memcpy(&DeviceConfigSettings, new_settings, sizeof(DeviceConfigSettings));
 132              		.loc 1 61 3 view .LVU17
 133 0006 134A     		ldr	r2, .L7
 134 0008 0068     		ldr	r0, [r0]	@ unaligned
 135              	.LVL12:
 136              		.loc 1 61 3 is_stmt 0 view .LVU18
 137 000a 1060     		str	r0, [r2]
 138 000c 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 139              	.LVL13:
 140              		.loc 1 61 3 view .LVU19
 141 000e 9380     		strh	r3, [r2, #4]	@ unaligned
  62:Core/Src/TMAG5170.c **** 
  63:Core/Src/TMAG5170.c ****   // saving the bytes to the appropriate places in the variable
  64:Core/Src/TMAG5170.c ****   uint16_t register_data = ((uint16_t)(DeviceConfigSettings.ConvAvg) << 12u); // tak sie powinno ro
 142              		.loc 1 64 3 is_stmt 1 view .LVU20
 143              		.loc 1 64 60 is_stmt 0 view .LVU21
 144 0010 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 145              		.loc 1 64 12 view .LVU22
 146 0012 1B03     		lsls	r3, r3, #12
 147 0014 9BB2     		uxth	r3, r3
 148              	.LVL14:
  65:Core/Src/TMAG5170.c ****   register_data |= ((uint16_t)(DeviceConfigSettings.MagTempCoef) << 8u);
 149              		.loc 1 65 3 is_stmt 1 view .LVU23
 150              		.loc 1 65 52 is_stmt 0 view .LVU24
 151 0016 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 152              		.loc 1 65 17 view .LVU25
 153 0018 43EA0123 		orr	r3, r3, r1, lsl #8
 154              	.LVL15:
 155              		.loc 1 65 17 view .LVU26
 156 001c 1BB2     		sxth	r3, r3
 157              	.LVL16:
  66:Core/Src/TMAG5170.c ****   register_data |= ((uint16_t)(DeviceConfigSettings.OperatingMode) << 4u);
 158              		.loc 1 66 3 is_stmt 1 view .LVU27
 159              		.loc 1 66 52 is_stmt 0 view .LVU28
 160 001e 9178     		ldrb	r1, [r2, #2]	@ zero_extendqisi2
 161              		.loc 1 66 17 view .LVU29
 162 0020 43EA0113 		orr	r3, r3, r1, lsl #4
 163              	.LVL17:
  67:Core/Src/TMAG5170.c ****   register_data |= ((uint16_t)(DeviceConfigSettings.TempChannelEnabled) << 3u);
 164              		.loc 1 67 3 is_stmt 1 view .LVU30
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 5


 165              		.loc 1 67 52 is_stmt 0 view .LVU31
 166 0024 D178     		ldrb	r1, [r2, #3]	@ zero_extendqisi2
 167              		.loc 1 67 17 view .LVU32
 168 0026 43EAC103 		orr	r3, r3, r1, lsl #3
 169              	.LVL18:
  68:Core/Src/TMAG5170.c ****   register_data |= ((uint16_t)(DeviceConfigSettings.TempRate) << 2u);
 170              		.loc 1 68 3 is_stmt 1 view .LVU33
 171              		.loc 1 68 52 is_stmt 0 view .LVU34
 172 002a 1279     		ldrb	r2, [r2, #4]	@ zero_extendqisi2
 173              		.loc 1 68 17 view .LVU35
 174 002c 43EA8203 		orr	r3, r3, r2, lsl #2
 175              	.LVL19:
  69:Core/Src/TMAG5170.c ****   register_data |= ((uint16_t)(DeviceConfigSettings.TempChannelEnabled) << 1u);
 176              		.loc 1 69 3 is_stmt 1 view .LVU36
 177              		.loc 1 69 17 is_stmt 0 view .LVU37
 178 0030 43EA4103 		orr	r3, r3, r1, lsl #1
 179              	.LVL20:
  70:Core/Src/TMAG5170.c **** 
  71:Core/Src/TMAG5170.c ****   uint8_t register_data_8[2];
 180              		.loc 1 71 3 is_stmt 1 view .LVU38
  72:Core/Src/TMAG5170.c ****   register_data_8[0] = register_data >> 8;
 181              		.loc 1 72 3 view .LVU39
 182              		.loc 1 72 22 is_stmt 0 view .LVU40
 183 0034 C3F30722 		ubfx	r2, r3, #8, #8
 184 0038 8DF80420 		strb	r2, [sp, #4]
  73:Core/Src/TMAG5170.c ****   register_data_8[1] = register_data;
 185              		.loc 1 73 3 is_stmt 1 view .LVU41
 186              		.loc 1 73 22 is_stmt 0 view .LVU42
 187 003c 8DF80530 		strb	r3, [sp, #5]
  74:Core/Src/TMAG5170.c **** 
  75:Core/Src/TMAG5170.c ****   // last 8 bits:
  76:Core/Src/TMAG5170.c ****   // 0b12345678
  77:Core/Src/TMAG5170.c ****   // 3 and 4 bits are cmd status
  78:Core/Src/TMAG5170.c ****   // 3 bit: CMD1
  79:Core/Src/TMAG5170.c ****   // CMD1 = 0 --> Display SET_COUNT[2:0] in STAT[2:0] bits at SDO next frame
  80:Core/Src/TMAG5170.c ****   // CMD1 = 1 --> Display DATA_TYPE[2:0] in STAT[2:0] bits at SDO next frame
  81:Core/Src/TMAG5170.c ****   // 4 bit: CMD0
  82:Core/Src/TMAG5170.c ****   // CMD0 = 0 --> no conversion start through command bits
  83:Core/Src/TMAG5170.c ****   // CMD0 = 1 --> start of conversion at the CS going high
  84:Core/Src/TMAG5170.c ****   // last 4 bits are CRC
  85:Core/Src/TMAG5170.c **** 
  86:Core/Src/TMAG5170.c ****   uint8_t StatusCRC = 0b00111100;
 188              		.loc 1 86 3 is_stmt 1 view .LVU43
 189              	.LVL21:
  87:Core/Src/TMAG5170.c **** 
  88:Core/Src/TMAG5170.c ****   TransmitData(register_address, register_data_8, StatusCRC);
 190              		.loc 1 88 3 view .LVU44
 191 0040 3C22     		movs	r2, #60
 192 0042 01A9     		add	r1, sp, #4
 193 0044 0020     		movs	r0, #0
 194 0046 FFF7FEFF 		bl	TransmitData
 195              	.LVL22:
  89:Core/Src/TMAG5170.c ****   
  90:Core/Src/TMAG5170.c ****   return ret;
 196              		.loc 1 90 3 view .LVU45
  91:Core/Src/TMAG5170.c **** }
 197              		.loc 1 91 1 is_stmt 0 view .LVU46
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 6


 198 004a 0020     		movs	r0, #0
 199 004c 03B0     		add	sp, sp, #12
 200              	.LCFI5:
 201              		.cfi_def_cfa_offset 4
 202              		@ sp needed
 203 004e 5DF804FB 		ldr	pc, [sp], #4
 204              	.L8:
 205 0052 00BF     		.align	2
 206              	.L7:
 207 0054 00000000 		.word	.LANCHOR0
 208              		.cfi_endproc
 209              	.LFE136:
 211              		.section	.text.TMAG5170_sens_conf_settings,"ax",%progbits
 212              		.align	1
 213              		.global	TMAG5170_sens_conf_settings
 214              		.syntax unified
 215              		.thumb
 216              		.thumb_func
 218              	TMAG5170_sens_conf_settings:
 219              	.LVL23:
 220              	.LFB137:
  92:Core/Src/TMAG5170.c **** 
  93:Core/Src/TMAG5170.c **** TMAG5170_return_code_t TMAG5170_sens_conf_settings(TMAG5170_SENSOR_CONFIG_settings_t *new_settings)
  94:Core/Src/TMAG5170.c **** {
 221              		.loc 1 94 1 is_stmt 1 view -0
 222              		.cfi_startproc
 223              		@ args = 0, pretend = 0, frame = 8
 224              		@ frame_needed = 0, uses_anonymous_args = 0
 225              		.loc 1 94 1 is_stmt 0 view .LVU48
 226 0000 00B5     		push	{lr}
 227              	.LCFI6:
 228              		.cfi_def_cfa_offset 4
 229              		.cfi_offset 14, -4
 230 0002 83B0     		sub	sp, sp, #12
 231              	.LCFI7:
 232              		.cfi_def_cfa_offset 16
 233 0004 0346     		mov	r3, r0
  95:Core/Src/TMAG5170.c ****   
  96:Core/Src/TMAG5170.c ****   register_address = TMAG5170_SENSOR_CONFIG_REG;
 234              		.loc 1 96 3 is_stmt 1 view .LVU49
 235              		.loc 1 96 20 is_stmt 0 view .LVU50
 236 0006 4FF0010C 		mov	ip, #1
 237 000a 144A     		ldr	r2, .L11
 238 000c 82F800C0 		strb	ip, [r2]
  97:Core/Src/TMAG5170.c ****   TMAG5170_return_code_t ret = TMAG5170_RET_OK;
 239              		.loc 1 97 3 is_stmt 1 view .LVU51
 240              	.LVL24:
  98:Core/Src/TMAG5170.c **** 
  99:Core/Src/TMAG5170.c ****   // copy bytes from settings to new_settings
 100:Core/Src/TMAG5170.c ****   memcpy(&SensorConfigSettings, new_settings, sizeof(SensorConfigSettings));
 241              		.loc 1 100 3 view .LVU52
 242 0010 134A     		ldr	r2, .L11+4
 243 0012 0068     		ldr	r0, [r0]	@ unaligned
 244              	.LVL25:
 245              		.loc 1 100 3 is_stmt 0 view .LVU53
 246 0014 1060     		str	r0, [r2]
 247 0016 9B88     		ldrh	r3, [r3, #4]	@ unaligned
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 7


 248              	.LVL26:
 249              		.loc 1 100 3 view .LVU54
 250 0018 9380     		strh	r3, [r2, #4]	@ unaligned
 101:Core/Src/TMAG5170.c **** 
 102:Core/Src/TMAG5170.c ****   // saving the bytes to the appropriate places in the variable
 103:Core/Src/TMAG5170.c ****   uint16_t register_data = (SensorConfigSettings.AngleEnabled << 14);
 251              		.loc 1 103 3 is_stmt 1 view .LVU55
 252              		.loc 1 103 49 is_stmt 0 view .LVU56
 253 001a 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 254              		.loc 1 103 12 view .LVU57
 255 001c 9B03     		lsls	r3, r3, #14
 256 001e 9BB2     		uxth	r3, r3
 257              	.LVL27:
 104:Core/Src/TMAG5170.c ****   register_data |= (SensorConfigSettings.SleepTime << 10);
 258              		.loc 1 104 3 is_stmt 1 view .LVU58
 259              		.loc 1 104 41 is_stmt 0 view .LVU59
 260 0020 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 261              		.loc 1 104 17 view .LVU60
 262 0022 43EA8123 		orr	r3, r3, r1, lsl #10
 263              	.LVL28:
 264              		.loc 1 104 17 view .LVU61
 265 0026 1BB2     		sxth	r3, r3
 266              	.LVL29:
 105:Core/Src/TMAG5170.c ****   register_data |= (SensorConfigSettings.MagChannelEnabled << 6);
 267              		.loc 1 105 3 is_stmt 1 view .LVU62
 268              		.loc 1 105 41 is_stmt 0 view .LVU63
 269 0028 9178     		ldrb	r1, [r2, #2]	@ zero_extendqisi2
 270              		.loc 1 105 17 view .LVU64
 271 002a 43EA8113 		orr	r3, r3, r1, lsl #6
 272              	.LVL30:
 106:Core/Src/TMAG5170.c ****   register_data |= (SensorConfigSettings.Zrange << 4);
 273              		.loc 1 106 3 is_stmt 1 view .LVU65
 274              		.loc 1 106 41 is_stmt 0 view .LVU66
 275 002e D178     		ldrb	r1, [r2, #3]	@ zero_extendqisi2
 276              		.loc 1 106 17 view .LVU67
 277 0030 43EA0113 		orr	r3, r3, r1, lsl #4
 278              	.LVL31:
 107:Core/Src/TMAG5170.c ****   register_data |= (SensorConfigSettings.Yrange << 2);
 279              		.loc 1 107 3 is_stmt 1 view .LVU68
 280              		.loc 1 107 41 is_stmt 0 view .LVU69
 281 0034 1179     		ldrb	r1, [r2, #4]	@ zero_extendqisi2
 282              		.loc 1 107 17 view .LVU70
 283 0036 43EA8103 		orr	r3, r3, r1, lsl #2
 284              	.LVL32:
 285              		.loc 1 107 17 view .LVU71
 286 003a 9BB2     		uxth	r3, r3
 287              	.LVL33:
 108:Core/Src/TMAG5170.c ****   register_data |= (SensorConfigSettings.Xrange << 0);
 288              		.loc 1 108 3 is_stmt 1 view .LVU72
 289              		.loc 1 108 41 is_stmt 0 view .LVU73
 290 003c 5279     		ldrb	r2, [r2, #5]	@ zero_extendqisi2
 291              		.loc 1 108 17 view .LVU74
 292 003e 1A43     		orrs	r2, r2, r3
 293              	.LVL34:
 109:Core/Src/TMAG5170.c **** 
 110:Core/Src/TMAG5170.c ****   uint8_t register_data_8[2];
 294              		.loc 1 110 3 is_stmt 1 view .LVU75
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 8


 111:Core/Src/TMAG5170.c ****   register_data_8[0] = register_data >> 8;
 295              		.loc 1 111 3 view .LVU76
 296              		.loc 1 111 22 is_stmt 0 view .LVU77
 297 0040 1B0A     		lsrs	r3, r3, #8
 298 0042 8DF80430 		strb	r3, [sp, #4]
 112:Core/Src/TMAG5170.c ****   register_data_8[1] = register_data;
 299              		.loc 1 112 3 is_stmt 1 view .LVU78
 300              		.loc 1 112 22 is_stmt 0 view .LVU79
 301 0046 8DF80520 		strb	r2, [sp, #5]
 113:Core/Src/TMAG5170.c **** 
 114:Core/Src/TMAG5170.c ****   uint8_t StatusCRC = 0b00111100;
 302              		.loc 1 114 3 is_stmt 1 view .LVU80
 303              	.LVL35:
 115:Core/Src/TMAG5170.c ****   TransmitData(register_address, register_data_8, StatusCRC);
 304              		.loc 1 115 3 view .LVU81
 305 004a 3C22     		movs	r2, #60
 306              	.LVL36:
 307              		.loc 1 115 3 is_stmt 0 view .LVU82
 308 004c 01A9     		add	r1, sp, #4
 309              	.LVL37:
 310              		.loc 1 115 3 view .LVU83
 311 004e 6046     		mov	r0, ip
 312 0050 FFF7FEFF 		bl	TransmitData
 313              	.LVL38:
 116:Core/Src/TMAG5170.c ****   
 117:Core/Src/TMAG5170.c ****   return ret;
 314              		.loc 1 117 3 is_stmt 1 view .LVU84
 118:Core/Src/TMAG5170.c **** }
 315              		.loc 1 118 1 is_stmt 0 view .LVU85
 316 0054 0020     		movs	r0, #0
 317 0056 03B0     		add	sp, sp, #12
 318              	.LCFI8:
 319              		.cfi_def_cfa_offset 4
 320              		@ sp needed
 321 0058 5DF804FB 		ldr	pc, [sp], #4
 322              	.L12:
 323              		.align	2
 324              	.L11:
 325 005c 00000000 		.word	.LANCHOR1
 326 0060 00000000 		.word	.LANCHOR2
 327              		.cfi_endproc
 328              	.LFE137:
 330              		.section	.text.TMAG5170_sys_conf_settings,"ax",%progbits
 331              		.align	1
 332              		.global	TMAG5170_sys_conf_settings
 333              		.syntax unified
 334              		.thumb
 335              		.thumb_func
 337              	TMAG5170_sys_conf_settings:
 338              	.LVL39:
 339              	.LFB138:
 119:Core/Src/TMAG5170.c **** 
 120:Core/Src/TMAG5170.c **** TMAG5170_return_code_t TMAG5170_sys_conf_settings(TMAG5170_SYSTEM_CONFIG_settings_t *new_settings)
 121:Core/Src/TMAG5170.c **** {
 340              		.loc 1 121 1 is_stmt 1 view -0
 341              		.cfi_startproc
 342              		@ args = 0, pretend = 0, frame = 8
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 9


 343              		@ frame_needed = 0, uses_anonymous_args = 0
 344              		.loc 1 121 1 is_stmt 0 view .LVU87
 345 0000 00B5     		push	{lr}
 346              	.LCFI9:
 347              		.cfi_def_cfa_offset 4
 348              		.cfi_offset 14, -4
 349 0002 83B0     		sub	sp, sp, #12
 350              	.LCFI10:
 351              		.cfi_def_cfa_offset 16
 352 0004 0346     		mov	r3, r0
 122:Core/Src/TMAG5170.c ****   
 123:Core/Src/TMAG5170.c ****   register_address = TMAG5170_SYSTEM_CONFIG_REG;
 353              		.loc 1 123 3 is_stmt 1 view .LVU88
 354              		.loc 1 123 20 is_stmt 0 view .LVU89
 355 0006 4FF0020C 		mov	ip, #2
 356 000a 174A     		ldr	r2, .L15
 357 000c 82F800C0 		strb	ip, [r2]
 124:Core/Src/TMAG5170.c ****   TMAG5170_return_code_t ret = TMAG5170_RET_OK;
 358              		.loc 1 124 3 is_stmt 1 view .LVU90
 359              	.LVL40:
 125:Core/Src/TMAG5170.c **** 
 126:Core/Src/TMAG5170.c ****   // copy bytes from settings to new_settings
 127:Core/Src/TMAG5170.c ****   memcpy(&SystemConfigSettings, new_settings, sizeof(SystemConfigSettings));
 360              		.loc 1 127 3 view .LVU91
 361 0010 164A     		ldr	r2, .L15+4
 362 0012 0068     		ldr	r0, [r0]	@ unaligned
 363              	.LVL41:
 364              		.loc 1 127 3 is_stmt 0 view .LVU92
 365 0014 1060     		str	r0, [r2]
 366 0016 9988     		ldrh	r1, [r3, #4]	@ unaligned
 367 0018 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 368              	.LVL42:
 369              		.loc 1 127 3 view .LVU93
 370 001a 9180     		strh	r1, [r2, #4]	@ unaligned
 371 001c 9371     		strb	r3, [r2, #6]
 128:Core/Src/TMAG5170.c **** 
 129:Core/Src/TMAG5170.c ****   // saving the bytes to the appropriate places in the variable
 130:Core/Src/TMAG5170.c ****   uint16_t register_data = (SystemConfigSettings.DiagnosticSelect << 12);
 372              		.loc 1 130 3 is_stmt 1 view .LVU94
 373              		.loc 1 130 49 is_stmt 0 view .LVU95
 374 001e 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 375              		.loc 1 130 12 view .LVU96
 376 0020 1B03     		lsls	r3, r3, #12
 377 0022 9BB2     		uxth	r3, r3
 378              	.LVL43:
 131:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.TriggerMode << 9);
 379              		.loc 1 131 3 is_stmt 1 view .LVU97
 380              		.loc 1 131 41 is_stmt 0 view .LVU98
 381 0024 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 382              		.loc 1 131 17 view .LVU99
 383 0026 43EA4123 		orr	r3, r3, r1, lsl #9
 384              	.LVL44:
 385              		.loc 1 131 17 view .LVU100
 386 002a 1BB2     		sxth	r3, r3
 387              	.LVL45:
 132:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.DataType << 6);
 388              		.loc 1 132 3 is_stmt 1 view .LVU101
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 10


 389              		.loc 1 132 41 is_stmt 0 view .LVU102
 390 002c 9178     		ldrb	r1, [r2, #2]	@ zero_extendqisi2
 391              		.loc 1 132 17 view .LVU103
 392 002e 43EA8113 		orr	r3, r3, r1, lsl #6
 393              	.LVL46:
 133:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.DiagnosticEnabled << 5);
 394              		.loc 1 133 3 is_stmt 1 view .LVU104
 395              		.loc 1 133 41 is_stmt 0 view .LVU105
 396 0032 D178     		ldrb	r1, [r2, #3]	@ zero_extendqisi2
 397              		.loc 1 133 17 view .LVU106
 398 0034 43EA4113 		orr	r3, r3, r1, lsl #5
 399              	.LVL47:
 134:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.ZlimitCheck << 2);
 400              		.loc 1 134 3 is_stmt 1 view .LVU107
 401              		.loc 1 134 41 is_stmt 0 view .LVU108
 402 0038 1179     		ldrb	r1, [r2, #4]	@ zero_extendqisi2
 403              		.loc 1 134 17 view .LVU109
 404 003a 43EA8103 		orr	r3, r3, r1, lsl #2
 405              	.LVL48:
 135:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.YlimitCheck << 1);
 406              		.loc 1 135 3 is_stmt 1 view .LVU110
 407              		.loc 1 135 41 is_stmt 0 view .LVU111
 408 003e 5179     		ldrb	r1, [r2, #5]	@ zero_extendqisi2
 409              		.loc 1 135 17 view .LVU112
 410 0040 43EA4103 		orr	r3, r3, r1, lsl #1
 411              	.LVL49:
 412              		.loc 1 135 17 view .LVU113
 413 0044 9BB2     		uxth	r3, r3
 414              	.LVL50:
 136:Core/Src/TMAG5170.c ****   register_data |= (SystemConfigSettings.XlimitCheck << 0);
 415              		.loc 1 136 3 is_stmt 1 view .LVU114
 416              		.loc 1 136 41 is_stmt 0 view .LVU115
 417 0046 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
 418              		.loc 1 136 17 view .LVU116
 419 0048 1A43     		orrs	r2, r2, r3
 420              	.LVL51:
 137:Core/Src/TMAG5170.c **** 
 138:Core/Src/TMAG5170.c ****   uint8_t register_data_8[2];
 421              		.loc 1 138 3 is_stmt 1 view .LVU117
 139:Core/Src/TMAG5170.c ****   register_data_8[0] = register_data >> 8;
 422              		.loc 1 139 3 view .LVU118
 423              		.loc 1 139 22 is_stmt 0 view .LVU119
 424 004a 1B0A     		lsrs	r3, r3, #8
 425 004c 8DF80430 		strb	r3, [sp, #4]
 140:Core/Src/TMAG5170.c ****   register_data_8[1] = register_data;
 426              		.loc 1 140 3 is_stmt 1 view .LVU120
 427              		.loc 1 140 22 is_stmt 0 view .LVU121
 428 0050 8DF80520 		strb	r2, [sp, #5]
 141:Core/Src/TMAG5170.c ****   
 142:Core/Src/TMAG5170.c ****   uint8_t StatusCRC = 0b00111100;
 429              		.loc 1 142 3 is_stmt 1 view .LVU122
 430              	.LVL52:
 143:Core/Src/TMAG5170.c **** 
 144:Core/Src/TMAG5170.c ****   // wysłanie
 145:Core/Src/TMAG5170.c ****   TransmitData(register_address, register_data_8, StatusCRC);
 431              		.loc 1 145 3 view .LVU123
 432 0054 3C22     		movs	r2, #60
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 11


 433              	.LVL53:
 434              		.loc 1 145 3 is_stmt 0 view .LVU124
 435 0056 01A9     		add	r1, sp, #4
 436              	.LVL54:
 437              		.loc 1 145 3 view .LVU125
 438 0058 6046     		mov	r0, ip
 439 005a FFF7FEFF 		bl	TransmitData
 440              	.LVL55:
 146:Core/Src/TMAG5170.c ****   
 147:Core/Src/TMAG5170.c ****   return ret;
 441              		.loc 1 147 3 is_stmt 1 view .LVU126
 148:Core/Src/TMAG5170.c **** }
 442              		.loc 1 148 1 is_stmt 0 view .LVU127
 443 005e 0020     		movs	r0, #0
 444 0060 03B0     		add	sp, sp, #12
 445              	.LCFI11:
 446              		.cfi_def_cfa_offset 4
 447              		@ sp needed
 448 0062 5DF804FB 		ldr	pc, [sp], #4
 449              	.L16:
 450 0066 00BF     		.align	2
 451              	.L15:
 452 0068 00000000 		.word	.LANCHOR1
 453 006c 00000000 		.word	.LANCHOR3
 454              		.cfi_endproc
 455              	.LFE138:
 457              		.section	.text.TMAG5170_al_conf_settings,"ax",%progbits
 458              		.align	1
 459              		.global	TMAG5170_al_conf_settings
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 464              	TMAG5170_al_conf_settings:
 465              	.LVL56:
 466              	.LFB139:
 149:Core/Src/TMAG5170.c **** 
 150:Core/Src/TMAG5170.c **** TMAG5170_return_code_t TMAG5170_al_conf_settings(TMAG5170_ALERT_CONFIG_settings_t *new_settings)
 151:Core/Src/TMAG5170.c **** {
 467              		.loc 1 151 1 is_stmt 1 view -0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 8
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471              		.loc 1 151 1 is_stmt 0 view .LVU129
 472 0000 00B5     		push	{lr}
 473              	.LCFI12:
 474              		.cfi_def_cfa_offset 4
 475              		.cfi_offset 14, -4
 476 0002 83B0     		sub	sp, sp, #12
 477              	.LCFI13:
 478              		.cfi_def_cfa_offset 16
 479 0004 8646     		mov	lr, r0
 152:Core/Src/TMAG5170.c ****   
 153:Core/Src/TMAG5170.c ****   register_address = TMAG5170_ALERT_CONFIG_REG;
 480              		.loc 1 153 3 is_stmt 1 view .LVU130
 481              		.loc 1 153 20 is_stmt 0 view .LVU131
 482 0006 4FF0030C 		mov	ip, #3
 483 000a 1C4B     		ldr	r3, .L19
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 12


 484 000c 83F800C0 		strb	ip, [r3]
 154:Core/Src/TMAG5170.c ****   TMAG5170_return_code_t ret = TMAG5170_RET_OK;
 485              		.loc 1 154 3 is_stmt 1 view .LVU132
 486              	.LVL57:
 155:Core/Src/TMAG5170.c **** 
 156:Core/Src/TMAG5170.c ****   // copy bytes from settings to new_settings
 157:Core/Src/TMAG5170.c ****   memcpy(&AlertConfigSettings, new_settings, sizeof(AlertConfigSettings));
 487              		.loc 1 157 3 view .LVU133
 488 0010 1B4A     		ldr	r2, .L19+4
 489 0012 1346     		mov	r3, r2
 490 0014 0068     		ldr	r0, [r0]	@ unaligned
 491              	.LVL58:
 492              		.loc 1 157 3 is_stmt 0 view .LVU134
 493 0016 DEF80410 		ldr	r1, [lr, #4]	@ unaligned
 494 001a 03C3     		stmia	r3!, {r0, r1}
 495 001c 9EF80810 		ldrb	r1, [lr, #8]	@ zero_extendqisi2
 496 0020 1970     		strb	r1, [r3]
 158:Core/Src/TMAG5170.c **** 
 159:Core/Src/TMAG5170.c ****   // saving the bytes to the appropriate places in the variable
 160:Core/Src/TMAG5170.c ****   uint16_t register_data = (AlertConfigSettings.AlertLatch << 13);
 497              		.loc 1 160 3 is_stmt 1 view .LVU135
 498              		.loc 1 160 48 is_stmt 0 view .LVU136
 499 0022 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 500              		.loc 1 160 12 view .LVU137
 501 0024 5B03     		lsls	r3, r3, #13
 502 0026 9BB2     		uxth	r3, r3
 503              	.LVL59:
 161:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.AlertMode << 12);
 504              		.loc 1 161 3 is_stmt 1 view .LVU138
 505              		.loc 1 161 40 is_stmt 0 view .LVU139
 506 0028 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 507              		.loc 1 161 17 view .LVU140
 508 002a 43EA0133 		orr	r3, r3, r1, lsl #12
 509              	.LVL60:
 510              		.loc 1 161 17 view .LVU141
 511 002e 1BB2     		sxth	r3, r3
 512              	.LVL61:
 162:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.AlertStatus << 11);
 513              		.loc 1 162 3 is_stmt 1 view .LVU142
 514              		.loc 1 162 40 is_stmt 0 view .LVU143
 515 0030 9178     		ldrb	r1, [r2, #2]	@ zero_extendqisi2
 516              		.loc 1 162 17 view .LVU144
 517 0032 43EAC123 		orr	r3, r3, r1, lsl #11
 518              	.LVL62:
 519              		.loc 1 162 17 view .LVU145
 520 0036 1BB2     		sxth	r3, r3
 521              	.LVL63:
 163:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.AlertResponse << 8);
 522              		.loc 1 163 3 is_stmt 1 view .LVU146
 523              		.loc 1 163 40 is_stmt 0 view .LVU147
 524 0038 D178     		ldrb	r1, [r2, #3]	@ zero_extendqisi2
 525              		.loc 1 163 17 view .LVU148
 526 003a 43EA0123 		orr	r3, r3, r1, lsl #8
 527              	.LVL64:
 528              		.loc 1 163 17 view .LVU149
 529 003e 1BB2     		sxth	r3, r3
 530              	.LVL65:
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 13


 164:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.ThresholdCount << 4);
 531              		.loc 1 164 3 is_stmt 1 view .LVU150
 532              		.loc 1 164 40 is_stmt 0 view .LVU151
 533 0040 1179     		ldrb	r1, [r2, #4]	@ zero_extendqisi2
 534              		.loc 1 164 17 view .LVU152
 535 0042 43EA0113 		orr	r3, r3, r1, lsl #4
 536              	.LVL66:
 165:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.TempThrAlert << 3);
 537              		.loc 1 165 3 is_stmt 1 view .LVU153
 538              		.loc 1 165 40 is_stmt 0 view .LVU154
 539 0046 5179     		ldrb	r1, [r2, #5]	@ zero_extendqisi2
 540              		.loc 1 165 17 view .LVU155
 541 0048 43EAC103 		orr	r3, r3, r1, lsl #3
 542              	.LVL67:
 166:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.ZthrAlert << 2);
 543              		.loc 1 166 3 is_stmt 1 view .LVU156
 544              		.loc 1 166 40 is_stmt 0 view .LVU157
 545 004c 9179     		ldrb	r1, [r2, #6]	@ zero_extendqisi2
 546              		.loc 1 166 17 view .LVU158
 547 004e 43EA8103 		orr	r3, r3, r1, lsl #2
 548              	.LVL68:
 167:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.YthrAlert << 1);
 549              		.loc 1 167 3 is_stmt 1 view .LVU159
 550              		.loc 1 167 40 is_stmt 0 view .LVU160
 551 0052 D179     		ldrb	r1, [r2, #7]	@ zero_extendqisi2
 552              		.loc 1 167 17 view .LVU161
 553 0054 43EA4103 		orr	r3, r3, r1, lsl #1
 554              	.LVL69:
 555              		.loc 1 167 17 view .LVU162
 556 0058 9BB2     		uxth	r3, r3
 557              	.LVL70:
 168:Core/Src/TMAG5170.c ****   register_data |= (AlertConfigSettings.XthrAlert << 0);
 558              		.loc 1 168 3 is_stmt 1 view .LVU163
 559              		.loc 1 168 40 is_stmt 0 view .LVU164
 560 005a 127A     		ldrb	r2, [r2, #8]	@ zero_extendqisi2
 561              		.loc 1 168 17 view .LVU165
 562 005c 1A43     		orrs	r2, r2, r3
 563              	.LVL71:
 169:Core/Src/TMAG5170.c **** 
 170:Core/Src/TMAG5170.c ****   
 171:Core/Src/TMAG5170.c ****   uint8_t register_data_8[2];
 564              		.loc 1 171 3 is_stmt 1 view .LVU166
 172:Core/Src/TMAG5170.c ****   register_data_8[0] = register_data >> 8;
 565              		.loc 1 172 3 view .LVU167
 566              		.loc 1 172 22 is_stmt 0 view .LVU168
 567 005e 1B0A     		lsrs	r3, r3, #8
 568 0060 8DF80430 		strb	r3, [sp, #4]
 173:Core/Src/TMAG5170.c ****   register_data_8[1] = register_data;
 569              		.loc 1 173 3 is_stmt 1 view .LVU169
 570              		.loc 1 173 22 is_stmt 0 view .LVU170
 571 0064 8DF80520 		strb	r2, [sp, #5]
 174:Core/Src/TMAG5170.c ****   
 175:Core/Src/TMAG5170.c ****   
 176:Core/Src/TMAG5170.c ****   uint8_t StatusCRC = 0b00111100;
 572              		.loc 1 176 3 is_stmt 1 view .LVU171
 573              	.LVL72:
 177:Core/Src/TMAG5170.c **** 
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 14


 178:Core/Src/TMAG5170.c ****   TransmitData(register_address, register_data_8, StatusCRC);
 574              		.loc 1 178 3 view .LVU172
 575 0068 3C22     		movs	r2, #60
 576              	.LVL73:
 577              		.loc 1 178 3 is_stmt 0 view .LVU173
 578 006a 01A9     		add	r1, sp, #4
 579              	.LVL74:
 580              		.loc 1 178 3 view .LVU174
 581 006c 6046     		mov	r0, ip
 582 006e FFF7FEFF 		bl	TransmitData
 583              	.LVL75:
 179:Core/Src/TMAG5170.c ****   
 180:Core/Src/TMAG5170.c ****   return ret;
 584              		.loc 1 180 3 is_stmt 1 view .LVU175
 181:Core/Src/TMAG5170.c **** }
 585              		.loc 1 181 1 is_stmt 0 view .LVU176
 586 0072 0020     		movs	r0, #0
 587 0074 03B0     		add	sp, sp, #12
 588              	.LCFI14:
 589              		.cfi_def_cfa_offset 4
 590              		@ sp needed
 591 0076 5DF804FB 		ldr	pc, [sp], #4
 592              	.L20:
 593 007a 00BF     		.align	2
 594              	.L19:
 595 007c 00000000 		.word	.LANCHOR1
 596 0080 00000000 		.word	.LANCHOR4
 597              		.cfi_endproc
 598              	.LFE139:
 600              		.section	.text.DisableCRC,"ax",%progbits
 601              		.align	1
 602              		.global	DisableCRC
 603              		.syntax unified
 604              		.thumb
 605              		.thumb_func
 607              	DisableCRC:
 608              	.LFB140:
 182:Core/Src/TMAG5170.c **** 
 183:Core/Src/TMAG5170.c **** void DisableCRC(void)
 184:Core/Src/TMAG5170.c **** {
 609              		.loc 1 184 1 is_stmt 1 view -0
 610              		.cfi_startproc
 611              		@ args = 0, pretend = 0, frame = 8
 612              		@ frame_needed = 0, uses_anonymous_args = 0
 613 0000 30B5     		push	{r4, r5, lr}
 614              	.LCFI15:
 615              		.cfi_def_cfa_offset 12
 616              		.cfi_offset 4, -12
 617              		.cfi_offset 5, -8
 618              		.cfi_offset 14, -4
 619 0002 83B0     		sub	sp, sp, #12
 620              	.LCFI16:
 621              		.cfi_def_cfa_offset 24
 185:Core/Src/TMAG5170.c **** 
 186:Core/Src/TMAG5170.c ****   uint8_t DisCRC[4];
 622              		.loc 1 186 3 view .LVU178
 187:Core/Src/TMAG5170.c ****   DisCRC[0] = 0x0F;
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 15


 623              		.loc 1 187 3 view .LVU179
 624              		.loc 1 187 13 is_stmt 0 view .LVU180
 625 0004 0F23     		movs	r3, #15
 626 0006 8DF80430 		strb	r3, [sp, #4]
 188:Core/Src/TMAG5170.c ****   DisCRC[1] = 0x00;
 627              		.loc 1 188 3 is_stmt 1 view .LVU181
 628              		.loc 1 188 13 is_stmt 0 view .LVU182
 629 000a 0022     		movs	r2, #0
 630 000c 8DF80520 		strb	r2, [sp, #5]
 189:Core/Src/TMAG5170.c ****   DisCRC[2] = 0x04;
 631              		.loc 1 189 3 is_stmt 1 view .LVU183
 632              		.loc 1 189 13 is_stmt 0 view .LVU184
 633 0010 0425     		movs	r5, #4
 634 0012 8DF80650 		strb	r5, [sp, #6]
 190:Core/Src/TMAG5170.c ****   DisCRC[3] = 0x07;
 635              		.loc 1 190 3 is_stmt 1 view .LVU185
 636              		.loc 1 190 13 is_stmt 0 view .LVU186
 637 0016 0723     		movs	r3, #7
 638 0018 8DF80730 		strb	r3, [sp, #7]
 191:Core/Src/TMAG5170.c ****   
 192:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 639              		.loc 1 192 3 is_stmt 1 view .LVU187
 640 001c 094C     		ldr	r4, .L23
 641 001e 1021     		movs	r1, #16
 642 0020 2046     		mov	r0, r4
 643 0022 FFF7FEFF 		bl	HAL_GPIO_WritePin
 644              	.LVL76:
 193:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, DisCRC, 4, HAL_MAX_DELAY);
 645              		.loc 1 193 3 view .LVU188
 646 0026 4FF0FF33 		mov	r3, #-1
 647 002a 2A46     		mov	r2, r5
 648 002c 0DEB0501 		add	r1, sp, r5
 649 0030 0548     		ldr	r0, .L23+4
 650 0032 FFF7FEFF 		bl	HAL_SPI_Transmit
 651              	.LVL77:
 194:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 652              		.loc 1 194 3 view .LVU189
 653 0036 0122     		movs	r2, #1
 654 0038 1021     		movs	r1, #16
 655 003a 2046     		mov	r0, r4
 656 003c FFF7FEFF 		bl	HAL_GPIO_WritePin
 657              	.LVL78:
 195:Core/Src/TMAG5170.c **** }
 658              		.loc 1 195 1 is_stmt 0 view .LVU190
 659 0040 03B0     		add	sp, sp, #12
 660              	.LCFI17:
 661              		.cfi_def_cfa_offset 12
 662              		@ sp needed
 663 0042 30BD     		pop	{r4, r5, pc}
 664              	.L24:
 665              		.align	2
 666              	.L23:
 667 0044 00040048 		.word	1207960576
 668 0048 00000000 		.word	hspi1
 669              		.cfi_endproc
 670              	.LFE140:
 672              		.section	.text.ReadRegister,"ax",%progbits
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 16


 673              		.align	1
 674              		.global	ReadRegister
 675              		.syntax unified
 676              		.thumb
 677              		.thumb_func
 679              	ReadRegister:
 680              	.LFB141:
 196:Core/Src/TMAG5170.c **** 
 197:Core/Src/TMAG5170.c **** void ReadRegister(void)
 198:Core/Src/TMAG5170.c **** {
 681              		.loc 1 198 1 is_stmt 1 view -0
 682              		.cfi_startproc
 683              		@ args = 0, pretend = 0, frame = 8
 684              		@ frame_needed = 0, uses_anonymous_args = 0
 685 0000 30B5     		push	{r4, r5, lr}
 686              	.LCFI18:
 687              		.cfi_def_cfa_offset 12
 688              		.cfi_offset 4, -12
 689              		.cfi_offset 5, -8
 690              		.cfi_offset 14, -4
 691 0002 83B0     		sub	sp, sp, #12
 692              	.LCFI19:
 693              		.cfi_def_cfa_offset 24
 199:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 694              		.loc 1 199 3 view .LVU192
 695 0004 144C     		ldr	r4, .L27
 696 0006 0022     		movs	r2, #0
 697 0008 1021     		movs	r1, #16
 698 000a 2046     		mov	r0, r4
 699 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 700              	.LVL79:
 200:Core/Src/TMAG5170.c **** 
 201:Core/Src/TMAG5170.c **** 
 202:Core/Src/TMAG5170.c ****   //register_address = TMAG5170_X_CH_RESULT_REG;
 203:Core/Src/TMAG5170.c ****   // switch (address)
 204:Core/Src/TMAG5170.c ****   // {
 205:Core/Src/TMAG5170.c ****   // case 1:
 206:Core/Src/TMAG5170.c ****   //   register_address = TMAG5170_Z_THRX_CONFIG_REG;
 207:Core/Src/TMAG5170.c ****   //   break;
 208:Core/Src/TMAG5170.c ****   // case 2:
 209:Core/Src/TMAG5170.c ****   //   register_address = TMAG5170_SYS_STATUS_REG;
 210:Core/Src/TMAG5170.c ****   // default:
 211:Core/Src/TMAG5170.c ****   //   break;
 212:Core/Src/TMAG5170.c ****   // }
 213:Core/Src/TMAG5170.c ****   
 214:Core/Src/TMAG5170.c ****   register_address = TMAG5170_ANGLE_RESULT_REG;
 701              		.loc 1 214 3 view .LVU193
 702              		.loc 1 214 20 is_stmt 0 view .LVU194
 703 0010 1323     		movs	r3, #19
 704 0012 124A     		ldr	r2, .L27+4
 705 0014 1370     		strb	r3, [r2]
 215:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 706              		.loc 1 215 3 is_stmt 1 view .LVU195
 707              		.loc 1 215 11 is_stmt 0 view .LVU196
 708 0016 8DF80730 		strb	r3, [sp, #7]
 216:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 709              		.loc 1 216 3 is_stmt 1 view .LVU197
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 17


 710              		.loc 1 216 14 is_stmt 0 view .LVU198
 711 001a 9323     		movs	r3, #147
 712 001c 8DF80730 		strb	r3, [sp, #7]
 217:Core/Src/TMAG5170.c **** 
 218:Core/Src/TMAG5170.c ****   //uint16_t zeros = 0x0000;
 219:Core/Src/TMAG5170.c ****   uint8_t crc = 0b00110000;
 713              		.loc 1 219 3 is_stmt 1 view .LVU199
 714              		.loc 1 219 11 is_stmt 0 view .LVU200
 715 0020 3023     		movs	r3, #48
 716 0022 8DF80630 		strb	r3, [sp, #6]
 220:Core/Src/TMAG5170.c ****   // wysłanie
 221:Core/Src/TMAG5170.c **** 
 222:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 3, HAL_MAX_DELAY);
 717              		.loc 1 222 3 is_stmt 1 view .LVU201
 718 0026 0E4D     		ldr	r5, .L27+8
 719 0028 4FF0FF33 		mov	r3, #-1
 720 002c 0322     		movs	r2, #3
 721 002e 0DF10701 		add	r1, sp, #7
 722 0032 2846     		mov	r0, r5
 723 0034 FFF7FEFF 		bl	HAL_SPI_Transmit
 724              	.LVL80:
 223:Core/Src/TMAG5170.c ****   //HAL_SPI_Transmit(&hspi1, &zeros, 2, HAL_MAX_DELAY);
 224:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &crc, 1, HAL_MAX_DELAY);
 725              		.loc 1 224 3 view .LVU202
 726 0038 4FF0FF33 		mov	r3, #-1
 727 003c 0122     		movs	r2, #1
 728 003e 0DF10601 		add	r1, sp, #6
 729 0042 2846     		mov	r0, r5
 730 0044 FFF7FEFF 		bl	HAL_SPI_Transmit
 731              	.LVL81:
 225:Core/Src/TMAG5170.c ****   //HAL_SPI_Receive(&hspi1, &RxData, 2, HAL_MAX_DELAY);
 226:Core/Src/TMAG5170.c **** 
 227:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 732              		.loc 1 227 3 view .LVU203
 733 0048 0122     		movs	r2, #1
 734 004a 1021     		movs	r1, #16
 735 004c 2046     		mov	r0, r4
 736 004e FFF7FEFF 		bl	HAL_GPIO_WritePin
 737              	.LVL82:
 228:Core/Src/TMAG5170.c **** 
 229:Core/Src/TMAG5170.c ****   //return RxData;
 230:Core/Src/TMAG5170.c **** }
 738              		.loc 1 230 1 is_stmt 0 view .LVU204
 739 0052 03B0     		add	sp, sp, #12
 740              	.LCFI20:
 741              		.cfi_def_cfa_offset 12
 742              		@ sp needed
 743 0054 30BD     		pop	{r4, r5, pc}
 744              	.L28:
 745 0056 00BF     		.align	2
 746              	.L27:
 747 0058 00040048 		.word	1207960576
 748 005c 00000000 		.word	.LANCHOR1
 749 0060 00000000 		.word	hspi1
 750              		.cfi_endproc
 751              	.LFE141:
 753              		.section	.text.ReadRegister1,"ax",%progbits
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 18


 754              		.align	1
 755              		.global	ReadRegister1
 756              		.syntax unified
 757              		.thumb
 758              		.thumb_func
 760              	ReadRegister1:
 761              	.LFB142:
 231:Core/Src/TMAG5170.c **** 
 232:Core/Src/TMAG5170.c **** void ReadRegister1(void)
 233:Core/Src/TMAG5170.c **** {
 762              		.loc 1 233 1 is_stmt 1 view -0
 763              		.cfi_startproc
 764              		@ args = 0, pretend = 0, frame = 8
 765              		@ frame_needed = 0, uses_anonymous_args = 0
 766 0000 30B5     		push	{r4, r5, lr}
 767              	.LCFI21:
 768              		.cfi_def_cfa_offset 12
 769              		.cfi_offset 4, -12
 770              		.cfi_offset 5, -8
 771              		.cfi_offset 14, -4
 772 0002 83B0     		sub	sp, sp, #12
 773              	.LCFI22:
 774              		.cfi_def_cfa_offset 24
 234:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 775              		.loc 1 234 3 view .LVU206
 776 0004 144C     		ldr	r4, .L31
 777 0006 0022     		movs	r2, #0
 778 0008 1021     		movs	r1, #16
 779 000a 2046     		mov	r0, r4
 780 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 781              	.LVL83:
 235:Core/Src/TMAG5170.c ****   //register_address = TMAG5170_X_CH_RESULT_REG;
 236:Core/Src/TMAG5170.c ****   // switch (address)
 237:Core/Src/TMAG5170.c ****   // {
 238:Core/Src/TMAG5170.c ****   // case 1:
 239:Core/Src/TMAG5170.c ****   //   register_address = TMAG5170_Z_THRX_CONFIG_REG;
 240:Core/Src/TMAG5170.c ****   //   break;
 241:Core/Src/TMAG5170.c ****   // case 2:
 242:Core/Src/TMAG5170.c ****   //   register_address = TMAG5170_SYS_STATUS_REG;
 243:Core/Src/TMAG5170.c ****   // default:
 244:Core/Src/TMAG5170.c ****   //   break;
 245:Core/Src/TMAG5170.c ****   // }
 246:Core/Src/TMAG5170.c ****   
 247:Core/Src/TMAG5170.c ****   //uint16_t RxData;
 248:Core/Src/TMAG5170.c **** 
 249:Core/Src/TMAG5170.c ****   register_address = TMAG5170_X_CH_RESULT_REG;
 782              		.loc 1 249 3 view .LVU207
 783              		.loc 1 249 20 is_stmt 0 view .LVU208
 784 0010 0923     		movs	r3, #9
 785 0012 124A     		ldr	r2, .L31+4
 786 0014 1370     		strb	r3, [r2]
 250:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 787              		.loc 1 250 3 is_stmt 1 view .LVU209
 788              		.loc 1 250 11 is_stmt 0 view .LVU210
 789 0016 8DF80730 		strb	r3, [sp, #7]
 251:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 790              		.loc 1 251 3 is_stmt 1 view .LVU211
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 19


 791              		.loc 1 251 14 is_stmt 0 view .LVU212
 792 001a 8923     		movs	r3, #137
 793 001c 8DF80730 		strb	r3, [sp, #7]
 252:Core/Src/TMAG5170.c **** 
 253:Core/Src/TMAG5170.c ****   //uint16_t zeros = 0x0000;
 254:Core/Src/TMAG5170.c ****   uint8_t crc = 0b00110000;
 794              		.loc 1 254 3 is_stmt 1 view .LVU213
 795              		.loc 1 254 11 is_stmt 0 view .LVU214
 796 0020 3023     		movs	r3, #48
 797 0022 8DF80630 		strb	r3, [sp, #6]
 255:Core/Src/TMAG5170.c ****   // wysłanie
 256:Core/Src/TMAG5170.c **** 
 257:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 3, HAL_MAX_DELAY);
 798              		.loc 1 257 3 is_stmt 1 view .LVU215
 799 0026 0E4D     		ldr	r5, .L31+8
 800 0028 4FF0FF33 		mov	r3, #-1
 801 002c 0322     		movs	r2, #3
 802 002e 0DF10701 		add	r1, sp, #7
 803 0032 2846     		mov	r0, r5
 804 0034 FFF7FEFF 		bl	HAL_SPI_Transmit
 805              	.LVL84:
 258:Core/Src/TMAG5170.c ****   //HAL_SPI_Transmit(&hspi1, &zeros, 2, HAL_MAX_DELAY);
 259:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &crc, 1, HAL_MAX_DELAY);
 806              		.loc 1 259 3 view .LVU216
 807 0038 4FF0FF33 		mov	r3, #-1
 808 003c 0122     		movs	r2, #1
 809 003e 0DF10601 		add	r1, sp, #6
 810 0042 2846     		mov	r0, r5
 811 0044 FFF7FEFF 		bl	HAL_SPI_Transmit
 812              	.LVL85:
 260:Core/Src/TMAG5170.c ****   //HAL_SPI_Receive(&hspi1, &RxData, 2, HAL_MAX_DELAY);
 261:Core/Src/TMAG5170.c **** 
 262:Core/Src/TMAG5170.c **** 
 263:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 813              		.loc 1 263 3 view .LVU217
 814 0048 0122     		movs	r2, #1
 815 004a 1021     		movs	r1, #16
 816 004c 2046     		mov	r0, r4
 817 004e FFF7FEFF 		bl	HAL_GPIO_WritePin
 818              	.LVL86:
 264:Core/Src/TMAG5170.c ****   //return RxData;
 265:Core/Src/TMAG5170.c **** }
 819              		.loc 1 265 1 is_stmt 0 view .LVU218
 820 0052 03B0     		add	sp, sp, #12
 821              	.LCFI23:
 822              		.cfi_def_cfa_offset 12
 823              		@ sp needed
 824 0054 30BD     		pop	{r4, r5, pc}
 825              	.L32:
 826 0056 00BF     		.align	2
 827              	.L31:
 828 0058 00040048 		.word	1207960576
 829 005c 00000000 		.word	.LANCHOR1
 830 0060 00000000 		.word	hspi1
 831              		.cfi_endproc
 832              	.LFE142:
 834              		.section	.rodata.GetmT.str1.4,"aMS",%progbits,1
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 20


 835              		.align	2
 836              	.LC0:
 837 0000 256400   		.ascii	"%d\000"
 838 0003 00       		.align	2
 839              	.LC1:
 840 0004 2E00     		.ascii	".\000"
 841 0006 0000     		.align	2
 842              	.LC2:
 843 0008 206D5400 		.ascii	" mT\000"
 844              		.section	.text.GetmT,"ax",%progbits
 845              		.align	1
 846              		.global	GetmT
 847              		.syntax unified
 848              		.thumb
 849              		.thumb_func
 851              	GetmT:
 852              	.LFB143:
 266:Core/Src/TMAG5170.c **** 
 267:Core/Src/TMAG5170.c **** void GetmT(void)
 268:Core/Src/TMAG5170.c **** {
 853              		.loc 1 268 1 is_stmt 1 view -0
 854              		.cfi_startproc
 855              		@ args = 0, pretend = 0, frame = 32
 856              		@ frame_needed = 0, uses_anonymous_args = 0
 857 0000 70B5     		push	{r4, r5, r6, lr}
 858              	.LCFI24:
 859              		.cfi_def_cfa_offset 16
 860              		.cfi_offset 4, -16
 861              		.cfi_offset 5, -12
 862              		.cfi_offset 6, -8
 863              		.cfi_offset 14, -4
 864 0002 88B0     		sub	sp, sp, #32
 865              	.LCFI25:
 866              		.cfi_def_cfa_offset 48
 867 0004 0024     		movs	r4, #0
 269:Core/Src/TMAG5170.c ****   // Received data
 270:Core/Src/TMAG5170.c ****   uint8_t RxData[2];
 868              		.loc 1 270 3 view .LVU220
 271:Core/Src/TMAG5170.c ****   uint16_t data_reg;
 869              		.loc 1 271 3 view .LVU221
 272:Core/Src/TMAG5170.c **** 
 273:Core/Src/TMAG5170.c ****   // wartosc pola magnetycznego w mT
 274:Core/Src/TMAG5170.c ****   float B = 0.0;
 870              		.loc 1 274 3 view .LVU222
 871              	.LVL87:
 275:Core/Src/TMAG5170.c **** 
 276:Core/Src/TMAG5170.c ****   // ustawiona czulosc sensora
 277:Core/Src/TMAG5170.c ****   uint8_t Br = TMAG5170_X_RANGE_50mT;
 872              		.loc 1 277 3 view .LVU223
 278:Core/Src/TMAG5170.c **** 
 279:Core/Src/TMAG5170.c ****   // sum of bits 0-14
 280:Core/Src/TMAG5170.c ****   uint16_t sum;
 873              		.loc 1 280 3 view .LVU224
 281:Core/Src/TMAG5170.c **** 
 282:Core/Src/TMAG5170.c **** 
 283:Core/Src/TMAG5170.c ****   // Send address
 284:Core/Src/TMAG5170.c ****   register_address = TMAG5170_X_CH_RESULT_REG;
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 21


 874              		.loc 1 284 3 view .LVU225
 875              		.loc 1 284 20 is_stmt 0 view .LVU226
 876 0006 0923     		movs	r3, #9
 877 0008 464A     		ldr	r2, .L37
 878 000a 1370     		strb	r3, [r2]
 285:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 879              		.loc 1 285 3 is_stmt 1 view .LVU227
 880              		.loc 1 285 11 is_stmt 0 view .LVU228
 881 000c 8DF81B30 		strb	r3, [sp, #27]
 286:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 882              		.loc 1 286 3 is_stmt 1 view .LVU229
 883              		.loc 1 286 14 is_stmt 0 view .LVU230
 884 0010 8923     		movs	r3, #137
 885 0012 8DF81B30 		strb	r3, [sp, #27]
 287:Core/Src/TMAG5170.c **** 
 288:Core/Src/TMAG5170.c ****   // CS LOW
 289:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 886              		.loc 1 289 3 is_stmt 1 view .LVU231
 887 0016 444D     		ldr	r5, .L37+4
 888 0018 2246     		mov	r2, r4
 889 001a 1021     		movs	r1, #16
 890 001c 2846     		mov	r0, r5
 891 001e FFF7FEFF 		bl	HAL_GPIO_WritePin
 892              	.LVL88:
 290:Core/Src/TMAG5170.c ****   // Transmit address
 291:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 1, HAL_MAX_DELAY);
 893              		.loc 1 291 3 view .LVU232
 894 0022 424E     		ldr	r6, .L37+8
 895 0024 4FF0FF33 		mov	r3, #-1
 896 0028 0122     		movs	r2, #1
 897 002a 0DF11B01 		add	r1, sp, #27
 898 002e 3046     		mov	r0, r6
 899 0030 FFF7FEFF 		bl	HAL_SPI_Transmit
 900              	.LVL89:
 292:Core/Src/TMAG5170.c ****   // Receive data
 293:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, RxData, 2, HAL_MAX_DELAY);
 901              		.loc 1 293 3 view .LVU233
 902 0034 4FF0FF33 		mov	r3, #-1
 903 0038 0222     		movs	r2, #2
 904 003a 07A9     		add	r1, sp, #28
 905 003c 3046     		mov	r0, r6
 906 003e FFF7FEFF 		bl	HAL_SPI_Receive
 907              	.LVL90:
 294:Core/Src/TMAG5170.c ****   // CS HIGH
 295:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 908              		.loc 1 295 3 view .LVU234
 909 0042 0122     		movs	r2, #1
 910 0044 1021     		movs	r1, #16
 911 0046 2846     		mov	r0, r5
 912 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 913              	.LVL91:
 296:Core/Src/TMAG5170.c **** 
 297:Core/Src/TMAG5170.c ****   // uint8_t to uint16_t
 298:Core/Src/TMAG5170.c ****   data_reg = RxData[0];
 914              		.loc 1 298 3 view .LVU235
 915              		.loc 1 298 12 is_stmt 0 view .LVU236
 916 004c 9DF81C30 		ldrb	r3, [sp, #28]	@ zero_extendqisi2
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 22


 917              	.LVL92:
 299:Core/Src/TMAG5170.c ****   data_reg = data_reg << 8;
 918              		.loc 1 299 3 is_stmt 1 view .LVU237
 300:Core/Src/TMAG5170.c ****   data_reg |= RxData[1];
 919              		.loc 1 300 3 view .LVU238
 920              		.loc 1 300 21 is_stmt 0 view .LVU239
 921 0050 9DF81D10 		ldrb	r1, [sp, #29]	@ zero_extendqisi2
 922              		.loc 1 300 12 view .LVU240
 923 0054 41EA0321 		orr	r1, r1, r3, lsl #8
 924              	.LVL93:
 301:Core/Src/TMAG5170.c **** 
 302:Core/Src/TMAG5170.c ****   // read MSB
 303:Core/Src/TMAG5170.c ****   uint16_t and = data_reg;
 925              		.loc 1 303 3 is_stmt 1 view .LVU241
 304:Core/Src/TMAG5170.c ****   uint16_t D15 = 0x8000 & and;
 926              		.loc 1 304 3 view .LVU242
 927              		.loc 1 304 12 is_stmt 0 view .LVU243
 928 0058 01F40043 		and	r3, r1, #32768
 929 005c 07EE903A 		vmov	s15, r3	@ int
 930              	.LVL94:
 305:Core/Src/TMAG5170.c **** 
 306:Core/Src/TMAG5170.c ****   // counting sum of bits 0-14
 307:Core/Src/TMAG5170.c ****   for(int i=0; i<=14; i++)
 931              		.loc 1 307 3 is_stmt 1 view .LVU244
 932              	.LBB2:
 933              		.loc 1 307 7 view .LVU245
 934              		.loc 1 307 11 is_stmt 0 view .LVU246
 935 0060 2346     		mov	r3, r4
 936              		.loc 1 307 3 view .LVU247
 937 0062 05E0     		b	.L34
 938              	.LVL95:
 939              	.L35:
 308:Core/Src/TMAG5170.c ****   {
 309:Core/Src/TMAG5170.c ****       sum += data_reg & (0b1 << i);
 940              		.loc 1 309 7 is_stmt 1 discriminator 3 view .LVU248
 941              		.loc 1 309 30 is_stmt 0 discriminator 3 view .LVU249
 942 0064 0122     		movs	r2, #1
 943 0066 9A40     		lsls	r2, r2, r3
 944              		.loc 1 309 23 discriminator 3 view .LVU250
 945 0068 0A40     		ands	r2, r2, r1
 946              		.loc 1 309 11 discriminator 3 view .LVU251
 947 006a 2244     		add	r2, r2, r4
 948 006c 94B2     		uxth	r4, r2
 949              	.LVL96:
 307:Core/Src/TMAG5170.c ****   {
 950              		.loc 1 307 23 is_stmt 1 discriminator 3 view .LVU252
 307:Core/Src/TMAG5170.c ****   {
 951              		.loc 1 307 24 is_stmt 0 discriminator 3 view .LVU253
 952 006e 0133     		adds	r3, r3, #1
 953              	.LVL97:
 954              	.L34:
 307:Core/Src/TMAG5170.c ****   {
 955              		.loc 1 307 16 is_stmt 1 discriminator 1 view .LVU254
 307:Core/Src/TMAG5170.c ****   {
 956              		.loc 1 307 3 is_stmt 0 discriminator 1 view .LVU255
 957 0070 0E2B     		cmp	r3, #14
 958 0072 F7DD     		ble	.L35
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 23


 959              	.LBE2:
 310:Core/Src/TMAG5170.c ****   }
 311:Core/Src/TMAG5170.c **** 
 312:Core/Src/TMAG5170.c ****   // put into the formula
 313:Core/Src/TMAG5170.c ****   B = (((float)D15 + (float)sum)/65536)*2*50;
 960              		.loc 1 313 3 is_stmt 1 view .LVU256
 961              		.loc 1 313 9 is_stmt 0 view .LVU257
 962 0074 B8EE677A 		vcvt.f32.u32	s14, s15
 963              		.loc 1 313 22 view .LVU258
 964 0078 07EE904A 		vmov	s15, r4	@ int
 965              	.LVL98:
 966              		.loc 1 313 22 view .LVU259
 967 007c F8EE677A 		vcvt.f32.u32	s15, s15
 968              		.loc 1 313 20 view .LVU260
 969 0080 77EE277A 		vadd.f32	s15, s14, s15
 970              		.loc 1 313 33 view .LVU261
 971 0084 9FED2A7A 		vldr.32	s14, .L37+12
 972 0088 67EE877A 		vmul.f32	s15, s15, s14
 973              		.loc 1 313 40 view .LVU262
 974 008c 77EEA77A 		vadd.f32	s15, s15, s15
 975              		.loc 1 313 5 view .LVU263
 976 0090 9FED287A 		vldr.32	s14, .L37+16
 977 0094 67EE877A 		vmul.f32	s15, s15, s14
 978              	.LVL99:
 314:Core/Src/TMAG5170.c **** 
 315:Core/Src/TMAG5170.c ****   // calculate numbers after dot
 316:Core/Src/TMAG5170.c ****   uint8_t t;
 979              		.loc 1 316 3 is_stmt 1 view .LVU264
 317:Core/Src/TMAG5170.c ****   t = (B - (int8_t)B)*100;
 980              		.loc 1 317 3 view .LVU265
 981              		.loc 1 317 12 is_stmt 0 view .LVU266
 982 0098 BDEEE77A 		vcvt.s32.f32	s14, s15
 983 009c 8DED017A 		vstr.32	s14, [sp, #4]	@ int
 984 00a0 9DF90420 		ldrsb	r2, [sp, #4]
 985              		.loc 1 317 10 view .LVU267
 986 00a4 07EE102A 		vmov	s14, r2	@ int
 987 00a8 B8EEC77A 		vcvt.f32.s32	s14, s14
 988 00ac 77EEC77A 		vsub.f32	s15, s15, s14
 989              	.LVL100:
 990              		.loc 1 317 22 view .LVU268
 991 00b0 9FED217A 		vldr.32	s14, .L37+20
 992 00b4 67EE877A 		vmul.f32	s15, s15, s14
 993              		.loc 1 317 5 view .LVU269
 994 00b8 FCEEE77A 		vcvt.u32.f32	s15, s15
 995 00bc CDED017A 		vstr.32	s15, [sp, #4]	@ int
 996 00c0 9DF80440 		ldrb	r4, [sp, #4]	@ zero_extendqisi2
 997              	.LVL101:
 318:Core/Src/TMAG5170.c **** 
 319:Core/Src/TMAG5170.c ****   char str1[8];
 998              		.loc 1 319 3 is_stmt 1 view .LVU270
 320:Core/Src/TMAG5170.c ****   char str2[8];
 999              		.loc 1 320 3 view .LVU271
 321:Core/Src/TMAG5170.c **** 
 322:Core/Src/TMAG5170.c ****   // converting to char
 323:Core/Src/TMAG5170.c ****   sprintf(str1, "%d", (int8_t)B);
 1000              		.loc 1 323 3 view .LVU272
 1001 00c4 1D4D     		ldr	r5, .L37+24
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 24


 1002 00c6 2946     		mov	r1, r5
 1003              	.LVL102:
 1004              		.loc 1 323 3 is_stmt 0 view .LVU273
 1005 00c8 04A8     		add	r0, sp, #16
 1006 00ca FFF7FEFF 		bl	sprintf
 1007              	.LVL103:
 324:Core/Src/TMAG5170.c ****   sprintf(str2, "%d", t); 
 1008              		.loc 1 324 3 is_stmt 1 view .LVU274
 1009 00ce 2246     		mov	r2, r4
 1010 00d0 2946     		mov	r1, r5
 1011 00d2 02A8     		add	r0, sp, #8
 1012 00d4 FFF7FEFF 		bl	sprintf
 1013              	.LVL104:
 325:Core/Src/TMAG5170.c **** 
 326:Core/Src/TMAG5170.c ****   // sending data to console
 327:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, str1, strlen(str1), HAL_MAX_DELAY);
 1014              		.loc 1 327 3 view .LVU275
 1015              		.loc 1 327 36 is_stmt 0 view .LVU276
 1016 00d8 04A8     		add	r0, sp, #16
 1017 00da FFF7FEFF 		bl	strlen
 1018              	.LVL105:
 1019              		.loc 1 327 3 view .LVU277
 1020 00de 184C     		ldr	r4, .L37+28
 1021              	.LVL106:
 1022              		.loc 1 327 3 view .LVU278
 1023 00e0 4FF0FF33 		mov	r3, #-1
 1024 00e4 82B2     		uxth	r2, r0
 1025 00e6 04A9     		add	r1, sp, #16
 1026 00e8 2046     		mov	r0, r4
 1027 00ea FFF7FEFF 		bl	HAL_UART_Transmit
 1028              	.LVL107:
 328:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, ".", strlen("."), HAL_MAX_DELAY);
 1029              		.loc 1 328 3 is_stmt 1 view .LVU279
 1030 00ee 4FF0FF33 		mov	r3, #-1
 1031 00f2 0122     		movs	r2, #1
 1032 00f4 1349     		ldr	r1, .L37+32
 1033 00f6 2046     		mov	r0, r4
 1034 00f8 FFF7FEFF 		bl	HAL_UART_Transmit
 1035              	.LVL108:
 329:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, str2, strlen(str2), HAL_MAX_DELAY);
 1036              		.loc 1 329 3 view .LVU280
 1037              		.loc 1 329 36 is_stmt 0 view .LVU281
 1038 00fc 02A8     		add	r0, sp, #8
 1039 00fe FFF7FEFF 		bl	strlen
 1040              	.LVL109:
 1041              		.loc 1 329 3 view .LVU282
 1042 0102 4FF0FF33 		mov	r3, #-1
 1043 0106 82B2     		uxth	r2, r0
 1044 0108 02A9     		add	r1, sp, #8
 1045 010a 2046     		mov	r0, r4
 1046 010c FFF7FEFF 		bl	HAL_UART_Transmit
 1047              	.LVL110:
 330:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, " mT", strlen(" mT"), HAL_MAX_DELAY);
 1048              		.loc 1 330 3 is_stmt 1 view .LVU283
 1049 0110 4FF0FF33 		mov	r3, #-1
 1050 0114 0322     		movs	r2, #3
 1051 0116 0C49     		ldr	r1, .L37+36
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 25


 1052 0118 2046     		mov	r0, r4
 1053 011a FFF7FEFF 		bl	HAL_UART_Transmit
 1054              	.LVL111:
 331:Core/Src/TMAG5170.c **** }
 1055              		.loc 1 331 1 is_stmt 0 view .LVU284
 1056 011e 08B0     		add	sp, sp, #32
 1057              	.LCFI26:
 1058              		.cfi_def_cfa_offset 16
 1059              		@ sp needed
 1060 0120 70BD     		pop	{r4, r5, r6, pc}
 1061              	.LVL112:
 1062              	.L38:
 1063              		.loc 1 331 1 view .LVU285
 1064 0122 00BF     		.align	2
 1065              	.L37:
 1066 0124 00000000 		.word	.LANCHOR1
 1067 0128 00040048 		.word	1207960576
 1068 012c 00000000 		.word	hspi1
 1069 0130 00008037 		.word	931135488
 1070 0134 00004842 		.word	1112014848
 1071 0138 0000C842 		.word	1120403456
 1072 013c 00000000 		.word	.LC0
 1073 0140 00000000 		.word	huart2
 1074 0144 04000000 		.word	.LC1
 1075 0148 08000000 		.word	.LC2
 1076              		.cfi_endproc
 1077              	.LFE143:
 1079              		.section	.text.ReadData,"ax",%progbits
 1080              		.align	1
 1081              		.global	ReadData
 1082              		.syntax unified
 1083              		.thumb
 1084              		.thumb_func
 1086              	ReadData:
 1087              	.LVL113:
 1088              	.LFB144:
 332:Core/Src/TMAG5170.c **** 
 333:Core/Src/TMAG5170.c **** uint16_t ReadData(uint8_t which_motor, uint8_t address)
 334:Core/Src/TMAG5170.c **** {
 1089              		.loc 1 334 1 is_stmt 1 view -0
 1090              		.cfi_startproc
 1091              		@ args = 0, pretend = 0, frame = 0
 1092              		@ frame_needed = 0, uses_anonymous_args = 0
 1093              		.loc 1 334 1 is_stmt 0 view .LVU287
 1094 0000 38B5     		push	{r3, r4, r5, lr}
 1095              	.LCFI27:
 1096              		.cfi_def_cfa_offset 16
 1097              		.cfi_offset 3, -16
 1098              		.cfi_offset 4, -12
 1099              		.cfi_offset 5, -8
 1100              		.cfi_offset 14, -4
 1101 0002 0C46     		mov	r4, r1
 335:Core/Src/TMAG5170.c ****   
 336:Core/Src/TMAG5170.c ****   uint16_t dataRx = 0;
 1102              		.loc 1 336 3 is_stmt 1 view .LVU288
 1103              	.LVL114:
 337:Core/Src/TMAG5170.c ****   
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 26


 338:Core/Src/TMAG5170.c **** 
 339:Core/Src/TMAG5170.c ****   // decydujemy ktory czujnik bedzie aktywny(aktywacja nastepuje stanem niskim)
 340:Core/Src/TMAG5170.c ****   switch (which_motor)
 1104              		.loc 1 340 3 view .LVU289
 1105 0004 0128     		cmp	r0, #1
 1106 0006 1DD0     		beq	.L40
 1107 0008 0228     		cmp	r0, #2
 1108 000a 2AD0     		beq	.L41
 1109              	.LVL115:
 1110              	.L42:
 341:Core/Src/TMAG5170.c ****   {
 342:Core/Src/TMAG5170.c ****   case 1:
 343:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 344:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 345:Core/Src/TMAG5170.c ****     HAL_Delay(50);
 346:Core/Src/TMAG5170.c ****     break;
 347:Core/Src/TMAG5170.c ****   
 348:Core/Src/TMAG5170.c ****   case 2:
 349:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 0);
 350:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 351:Core/Src/TMAG5170.c ****     break;
 352:Core/Src/TMAG5170.c ****   default:
 353:Core/Src/TMAG5170.c ****     break;
 354:Core/Src/TMAG5170.c ****   }
 355:Core/Src/TMAG5170.c **** 
 356:Core/Src/TMAG5170.c ****   //wysylamy adres 
 357:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, address, 1, HAL_MAX_DELAY);
 1111              		.loc 1 357 3 view .LVU290
 1112 000c 1B4D     		ldr	r5, .L44
 1113 000e 4FF0FF33 		mov	r3, #-1
 1114 0012 0122     		movs	r2, #1
 1115 0014 2146     		mov	r1, r4
 1116 0016 2846     		mov	r0, r5
 1117 0018 FFF7FEFF 		bl	HAL_SPI_Transmit
 1118              	.LVL116:
 358:Core/Src/TMAG5170.c ****   // odbieramy 2 ramki danych
 359:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, dataRx, 2, HAL_MAX_DELAY);
 1119              		.loc 1 359 3 view .LVU291
 1120 001c 4FF0FF33 		mov	r3, #-1
 1121 0020 0222     		movs	r2, #2
 1122 0022 0021     		movs	r1, #0
 1123 0024 2846     		mov	r0, r5
 1124 0026 FFF7FEFF 		bl	HAL_SPI_Receive
 1125              	.LVL117:
 360:Core/Src/TMAG5170.c **** 
 361:Core/Src/TMAG5170.c **** 
 362:Core/Src/TMAG5170.c **** 
 363:Core/Src/TMAG5170.c ****   //po skonczonej transmisji  dezaktywujemy urzadzenia
 364:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1126              		.loc 1 364 3 view .LVU292
 1127 002a 0122     		movs	r2, #1
 1128 002c 1021     		movs	r1, #16
 1129 002e 1448     		ldr	r0, .L44+4
 1130 0030 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1131              	.LVL118:
 365:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1132              		.loc 1 365 3 view .LVU293
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 27


 1133 0034 0122     		movs	r2, #1
 1134 0036 4FF48071 		mov	r1, #256
 1135 003a 1248     		ldr	r0, .L44+8
 1136 003c FFF7FEFF 		bl	HAL_GPIO_WritePin
 1137              	.LVL119:
 366:Core/Src/TMAG5170.c **** 
 367:Core/Src/TMAG5170.c ****   return dataRx;
 1138              		.loc 1 367 3 view .LVU294
 368:Core/Src/TMAG5170.c **** }
 1139              		.loc 1 368 1 is_stmt 0 view .LVU295
 1140 0040 0020     		movs	r0, #0
 1141 0042 38BD     		pop	{r3, r4, r5, pc}
 1142              	.LVL120:
 1143              	.L40:
 343:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1144              		.loc 1 343 5 is_stmt 1 view .LVU296
 1145 0044 0022     		movs	r2, #0
 1146 0046 1021     		movs	r1, #16
 1147              	.LVL121:
 343:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1148              		.loc 1 343 5 is_stmt 0 view .LVU297
 1149 0048 0D48     		ldr	r0, .L44+4
 1150              	.LVL122:
 343:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1151              		.loc 1 343 5 view .LVU298
 1152 004a FFF7FEFF 		bl	HAL_GPIO_WritePin
 1153              	.LVL123:
 344:Core/Src/TMAG5170.c ****     HAL_Delay(50);
 1154              		.loc 1 344 5 is_stmt 1 view .LVU299
 1155 004e 0122     		movs	r2, #1
 1156 0050 4FF48071 		mov	r1, #256
 1157 0054 0B48     		ldr	r0, .L44+8
 1158 0056 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1159              	.LVL124:
 345:Core/Src/TMAG5170.c ****     break;
 1160              		.loc 1 345 5 view .LVU300
 1161 005a 3220     		movs	r0, #50
 1162 005c FFF7FEFF 		bl	HAL_Delay
 1163              	.LVL125:
 346:Core/Src/TMAG5170.c ****   
 1164              		.loc 1 346 5 view .LVU301
 1165 0060 D4E7     		b	.L42
 1166              	.LVL126:
 1167              	.L41:
 349:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1168              		.loc 1 349 5 view .LVU302
 1169 0062 0022     		movs	r2, #0
 1170 0064 4FF48071 		mov	r1, #256
 1171              	.LVL127:
 349:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1172              		.loc 1 349 5 is_stmt 0 view .LVU303
 1173 0068 0648     		ldr	r0, .L44+8
 1174              	.LVL128:
 349:Core/Src/TMAG5170.c ****     HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1175              		.loc 1 349 5 view .LVU304
 1176 006a FFF7FEFF 		bl	HAL_GPIO_WritePin
 1177              	.LVL129:
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 28


 350:Core/Src/TMAG5170.c ****     break;
 1178              		.loc 1 350 5 is_stmt 1 view .LVU305
 1179 006e 0122     		movs	r2, #1
 1180 0070 1021     		movs	r1, #16
 1181 0072 0348     		ldr	r0, .L44+4
 1182 0074 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1183              	.LVL130:
 351:Core/Src/TMAG5170.c ****   default:
 1184              		.loc 1 351 5 view .LVU306
 1185 0078 C8E7     		b	.L42
 1186              	.L45:
 1187 007a 00BF     		.align	2
 1188              	.L44:
 1189 007c 00000000 		.word	hspi1
 1190 0080 00040048 		.word	1207960576
 1191 0084 00080048 		.word	1207961600
 1192              		.cfi_endproc
 1193              	.LFE144:
 1195              		.section	.text.GetAngle,"ax",%progbits
 1196              		.align	1
 1197              		.global	GetAngle
 1198              		.syntax unified
 1199              		.thumb
 1200              		.thumb_func
 1202              	GetAngle:
 1203              	.LFB145:
 369:Core/Src/TMAG5170.c **** 
 370:Core/Src/TMAG5170.c **** 
 371:Core/Src/TMAG5170.c **** // void GetAngle(uint8_t which_motor)
 372:Core/Src/TMAG5170.c **** // {
 373:Core/Src/TMAG5170.c **** 
 374:Core/Src/TMAG5170.c **** //   uint8_t address = 0;
 375:Core/Src/TMAG5170.c **** //   uint16_t raw_angle = 0;
 376:Core/Src/TMAG5170.c **** 
 377:Core/Src/TMAG5170.c **** //   // wysylamy na poczatek ramki czy chcemy odczytac czy zapisac oraz adres rejestru
 378:Core/Src/TMAG5170.c **** //   // 1 dla odczytu
 379:Core/Src/TMAG5170.c **** //   // 0 dla zapisu
 380:Core/Src/TMAG5170.c **** //   address = TMAG5170_ANGLE_RESULT_REG;
 381:Core/Src/TMAG5170.c **** //   address = address | 0b1 << 7;
 382:Core/Src/TMAG5170.c **** 
 383:Core/Src/TMAG5170.c **** 
 384:Core/Src/TMAG5170.c **** //   raw_angle = ReadData(which_motor, address);
 385:Core/Src/TMAG5170.c **** 
 386:Core/Src/TMAG5170.c **** // }
 387:Core/Src/TMAG5170.c **** 
 388:Core/Src/TMAG5170.c **** 
 389:Core/Src/TMAG5170.c **** 
 390:Core/Src/TMAG5170.c **** float GetAngle(void)
 391:Core/Src/TMAG5170.c **** {
 1204              		.loc 1 391 1 view -0
 1205              		.cfi_startproc
 1206              		@ args = 0, pretend = 0, frame = 8
 1207              		@ frame_needed = 0, uses_anonymous_args = 0
 1208 0000 70B5     		push	{r4, r5, r6, lr}
 1209              	.LCFI28:
 1210              		.cfi_def_cfa_offset 16
 1211              		.cfi_offset 4, -16
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 29


 1212              		.cfi_offset 5, -12
 1213              		.cfi_offset 6, -8
 1214              		.cfi_offset 14, -4
 1215 0002 82B0     		sub	sp, sp, #8
 1216              	.LCFI29:
 1217              		.cfi_def_cfa_offset 24
 392:Core/Src/TMAG5170.c ****   
 393:Core/Src/TMAG5170.c ****   uint8_t data[2] = { 0 };
 1218              		.loc 1 393 3 view .LVU308
 1219              		.loc 1 393 11 is_stmt 0 view .LVU309
 1220 0004 0022     		movs	r2, #0
 1221 0006 ADF80420 		strh	r2, [sp, #4]	@ movhi
 394:Core/Src/TMAG5170.c ****   uint16_t data_reg = 0;
 1222              		.loc 1 394 3 is_stmt 1 view .LVU310
 1223              	.LVL131:
 395:Core/Src/TMAG5170.c ****   uint16_t data_reg_LSB = 0;
 1224              		.loc 1 395 3 view .LVU311
 396:Core/Src/TMAG5170.c ****   uint16_t data_reg_MSB = 0;
 1225              		.loc 1 396 3 view .LVU312
 397:Core/Src/TMAG5170.c **** 
 398:Core/Src/TMAG5170.c ****   
 399:Core/Src/TMAG5170.c ****   // Angle in degree
 400:Core/Src/TMAG5170.c ****   float Angle = 0.0;
 1226              		.loc 1 400 3 view .LVU313
 401:Core/Src/TMAG5170.c ****   
 402:Core/Src/TMAG5170.c **** 
 403:Core/Src/TMAG5170.c ****   //wysyłamy adres
 404:Core/Src/TMAG5170.c ****   register_address = TMAG5170_ANGLE_RESULT_REG;
 1227              		.loc 1 404 3 view .LVU314
 1228              		.loc 1 404 20 is_stmt 0 view .LVU315
 1229 000a 1323     		movs	r3, #19
 1230 000c 2649     		ldr	r1, .L48
 1231 000e 0B70     		strb	r3, [r1]
 405:Core/Src/TMAG5170.c ****   // register_address = TMAG5170_ANGLE_RESULT_REG;
 406:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 1232              		.loc 1 406 3 is_stmt 1 view .LVU316
 1233              		.loc 1 406 11 is_stmt 0 view .LVU317
 1234 0010 8DF80330 		strb	r3, [sp, #3]
 407:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 1235              		.loc 1 407 3 is_stmt 1 view .LVU318
 1236              		.loc 1 407 14 is_stmt 0 view .LVU319
 1237 0014 9323     		movs	r3, #147
 1238 0016 8DF80330 		strb	r3, [sp, #3]
 408:Core/Src/TMAG5170.c **** 
 409:Core/Src/TMAG5170.c **** 
 410:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 1239              		.loc 1 410 3 is_stmt 1 view .LVU320
 1240 001a 244D     		ldr	r5, .L48+4
 1241 001c 1021     		movs	r1, #16
 1242 001e 2846     		mov	r0, r5
 1243 0020 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1244              	.LVL132:
 411:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1245              		.loc 1 411 3 view .LVU321
 1246 0024 224C     		ldr	r4, .L48+8
 1247 0026 0122     		movs	r2, #1
 1248 0028 4FF48071 		mov	r1, #256
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 30


 1249 002c 2046     		mov	r0, r4
 1250 002e FFF7FEFF 		bl	HAL_GPIO_WritePin
 1251              	.LVL133:
 412:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 1, HAL_MAX_DELAY);
 1252              		.loc 1 412 3 view .LVU322
 1253 0032 204E     		ldr	r6, .L48+12
 1254 0034 4FF0FF33 		mov	r3, #-1
 1255 0038 0122     		movs	r2, #1
 1256 003a 0DF10301 		add	r1, sp, #3
 1257 003e 3046     		mov	r0, r6
 1258 0040 FFF7FEFF 		bl	HAL_SPI_Transmit
 1259              	.LVL134:
 413:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, data, 2, HAL_MAX_DELAY);
 1260              		.loc 1 413 3 view .LVU323
 1261 0044 4FF0FF33 		mov	r3, #-1
 1262 0048 0222     		movs	r2, #2
 1263 004a 01A9     		add	r1, sp, #4
 1264 004c 3046     		mov	r0, r6
 1265 004e FFF7FEFF 		bl	HAL_SPI_Receive
 1266              	.LVL135:
 414:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1267              		.loc 1 414 3 view .LVU324
 1268 0052 0122     		movs	r2, #1
 1269 0054 1021     		movs	r1, #16
 1270 0056 2846     		mov	r0, r5
 1271 0058 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1272              	.LVL136:
 415:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, 1);
 1273              		.loc 1 415 3 view .LVU325
 1274 005c 0122     		movs	r2, #1
 1275 005e 4FF48071 		mov	r1, #256
 1276 0062 2046     		mov	r0, r4
 1277 0064 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1278              	.LVL137:
 416:Core/Src/TMAG5170.c ****     
 417:Core/Src/TMAG5170.c ****   data_reg = data[0];
 1279              		.loc 1 417 3 view .LVU326
 1280              		.loc 1 417 12 is_stmt 0 view .LVU327
 1281 0068 9DF80420 		ldrb	r2, [sp, #4]	@ zero_extendqisi2
 1282              	.LVL138:
 418:Core/Src/TMAG5170.c ****   data_reg = data_reg << 8;
 1283              		.loc 1 418 3 is_stmt 1 view .LVU328
 419:Core/Src/TMAG5170.c ****   data_reg |= data[1];
 1284              		.loc 1 419 3 view .LVU329
 1285              		.loc 1 419 19 is_stmt 0 view .LVU330
 1286 006c 9DF80530 		ldrb	r3, [sp, #5]	@ zero_extendqisi2
 1287              		.loc 1 419 12 view .LVU331
 1288 0070 43EA0222 		orr	r2, r3, r2, lsl #8
 1289              	.LVL139:
 420:Core/Src/TMAG5170.c **** 
 421:Core/Src/TMAG5170.c **** 
 422:Core/Src/TMAG5170.c ****   data_reg_LSB = data[1];
 1290              		.loc 1 422 3 is_stmt 1 view .LVU332
 423:Core/Src/TMAG5170.c ****   //zostawimy tylko ostatnie 4 bity
 424:Core/Src/TMAG5170.c ****   data_reg_LSB = data_reg_LSB & 0x0F;
 1291              		.loc 1 424 3 view .LVU333
 1292              		.loc 1 424 16 is_stmt 0 view .LVU334
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 31


 1293 0074 03F00F03 		and	r3, r3, #15
 1294              	.LVL140:
 425:Core/Src/TMAG5170.c ****   // LSB = (float)data_reg_LSB;
 426:Core/Src/TMAG5170.c ****   // LSB = LSB/8;
 427:Core/Src/TMAG5170.c ****   data_reg_LSB = data_reg_LSB * 100;
 1295              		.loc 1 427 3 is_stmt 1 view .LVU335
 1296              		.loc 1 427 16 is_stmt 0 view .LVU336
 1297 0078 03EB8303 		add	r3, r3, r3, lsl #2
 1298              	.LVL141:
 1299              		.loc 1 427 16 view .LVU337
 1300 007c 03EB8303 		add	r3, r3, r3, lsl #2
 1301 0080 9900     		lsls	r1, r3, #2
 1302              	.LVL142:
 428:Core/Src/TMAG5170.c ****   data_reg_LSB = data_reg_LSB/16;
 1303              		.loc 1 428 3 is_stmt 1 view .LVU338
 1304              		.loc 1 428 16 is_stmt 0 view .LVU339
 1305 0082 0909     		lsrs	r1, r1, #4
 1306              	.LVL143:
 429:Core/Src/TMAG5170.c ****   
 430:Core/Src/TMAG5170.c **** 
 431:Core/Src/TMAG5170.c **** 
 432:Core/Src/TMAG5170.c ****   data_reg_MSB = data_reg & 0x1FF0;
 1307              		.loc 1 432 3 is_stmt 1 view .LVU340
 433:Core/Src/TMAG5170.c ****   data_reg_MSB = data_reg >> 4;
 1308              		.loc 1 433 3 view .LVU341
 1309              		.loc 1 433 16 is_stmt 0 view .LVU342
 1310 0084 1209     		lsrs	r2, r2, #4
 1311              	.LVL144:
 434:Core/Src/TMAG5170.c **** 
 435:Core/Src/TMAG5170.c ****   Angle = data_reg_MSB + data_reg_LSB/(float)100;
 1312              		.loc 1 435 3 is_stmt 1 view .LVU343
 1313              		.loc 1 435 24 is_stmt 0 view .LVU344
 1314 0086 07EE902A 		vmov	s15, r2	@ int
 1315 008a F8EEE77A 		vcvt.f32.s32	s15, s15
 1316              		.loc 1 435 38 view .LVU345
 1317 008e 07EE101A 		vmov	s14, r1	@ int
 1318 0092 B8EEC77A 		vcvt.f32.s32	s14, s14
 1319 0096 DFED086A 		vldr.32	s13, .L48+16
 1320 009a 87EE260A 		vdiv.f32	s0, s14, s13
 1321              	.LVL145:
 436:Core/Src/TMAG5170.c **** 
 437:Core/Src/TMAG5170.c ****   // MSB = (float)data_reg_MSB;
 438:Core/Src/TMAG5170.c ****   // Angle_uint = (data_reg_MSB * 1000) + data_reg_LSB;
 439:Core/Src/TMAG5170.c ****   // Angle = Angle_uint/1000;
 440:Core/Src/TMAG5170.c **** 
 441:Core/Src/TMAG5170.c ****   // Angle = MSB + LSB;
 442:Core/Src/TMAG5170.c **** 
 443:Core/Src/TMAG5170.c ****   return Angle;
 1322              		.loc 1 443 3 is_stmt 1 view .LVU346
 444:Core/Src/TMAG5170.c **** }
 1323              		.loc 1 444 1 is_stmt 0 view .LVU347
 1324 009e 37EE800A 		vadd.f32	s0, s15, s0
 1325              	.LVL146:
 1326              		.loc 1 444 1 view .LVU348
 1327 00a2 02B0     		add	sp, sp, #8
 1328              	.LCFI30:
 1329              		.cfi_def_cfa_offset 16
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 32


 1330              		@ sp needed
 1331 00a4 70BD     		pop	{r4, r5, r6, pc}
 1332              	.LVL147:
 1333              	.L49:
 1334              		.loc 1 444 1 view .LVU349
 1335 00a6 00BF     		.align	2
 1336              	.L48:
 1337 00a8 00000000 		.word	.LANCHOR1
 1338 00ac 00040048 		.word	1207960576
 1339 00b0 00080048 		.word	1207961600
 1340 00b4 00000000 		.word	hspi1
 1341 00b8 0000C842 		.word	1120403456
 1342              		.cfi_endproc
 1343              	.LFE145:
 1345              		.global	__aeabi_i2d
 1346              		.global	__aeabi_dadd
 1347              		.global	__aeabi_ddiv
 1348              		.global	__aeabi_d2f
 1349              		.section	.text.GetTemp,"ax",%progbits
 1350              		.align	1
 1351              		.global	GetTemp
 1352              		.syntax unified
 1353              		.thumb
 1354              		.thumb_func
 1356              	GetTemp:
 1357              	.LFB146:
 445:Core/Src/TMAG5170.c **** 
 446:Core/Src/TMAG5170.c **** 
 447:Core/Src/TMAG5170.c **** float GetTemp()
 448:Core/Src/TMAG5170.c **** {
 1358              		.loc 1 448 1 is_stmt 1 view -0
 1359              		.cfi_startproc
 1360              		@ args = 0, pretend = 0, frame = 8
 1361              		@ frame_needed = 0, uses_anonymous_args = 0
 1362 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1363              	.LCFI31:
 1364              		.cfi_def_cfa_offset 20
 1365              		.cfi_offset 4, -20
 1366              		.cfi_offset 5, -16
 1367              		.cfi_offset 6, -12
 1368              		.cfi_offset 7, -8
 1369              		.cfi_offset 14, -4
 1370 0002 83B0     		sub	sp, sp, #12
 1371              	.LCFI32:
 1372              		.cfi_def_cfa_offset 32
 449:Core/Src/TMAG5170.c ****   float temp = 0.0;
 1373              		.loc 1 449 3 view .LVU351
 1374              	.LVL148:
 450:Core/Src/TMAG5170.c ****   uint8_t buff[2];
 1375              		.loc 1 450 3 view .LVU352
 451:Core/Src/TMAG5170.c ****   uint16_t TADCt;
 1376              		.loc 1 451 3 view .LVU353
 452:Core/Src/TMAG5170.c **** 
 453:Core/Src/TMAG5170.c ****   // float temperature = 0.0;
 454:Core/Src/TMAG5170.c ****   // uint8_t UART_buff;
 455:Core/Src/TMAG5170.c ****   // uint16_t UART_buff_length;
 456:Core/Src/TMAG5170.c **** 
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 33


 457:Core/Src/TMAG5170.c ****   
 458:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 1377              		.loc 1 458 3 view .LVU354
 1378 0004 2A4F     		ldr	r7, .L52+8
 1379 0006 0022     		movs	r2, #0
 1380 0008 1021     		movs	r1, #16
 1381 000a 3846     		mov	r0, r7
 1382 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 1383              	.LVL149:
 459:Core/Src/TMAG5170.c **** 
 460:Core/Src/TMAG5170.c ****   register_address = TMAG5170_TEMP_RESULT_REG;
 1384              		.loc 1 460 3 view .LVU355
 1385              		.loc 1 460 20 is_stmt 0 view .LVU356
 1386 0010 0C23     		movs	r3, #12
 1387 0012 284A     		ldr	r2, .L52+12
 1388 0014 1370     		strb	r3, [r2]
 461:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 1389              		.loc 1 461 3 is_stmt 1 view .LVU357
 1390              		.loc 1 461 11 is_stmt 0 view .LVU358
 1391 0016 8DF80330 		strb	r3, [sp, #3]
 462:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 1392              		.loc 1 462 3 is_stmt 1 view .LVU359
 1393              		.loc 1 462 14 is_stmt 0 view .LVU360
 1394 001a 8C23     		movs	r3, #140
 1395 001c 8DF80330 		strb	r3, [sp, #3]
 463:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 1, HAL_MAX_DELAY);
 1396              		.loc 1 463 3 is_stmt 1 view .LVU361
 1397 0020 254D     		ldr	r5, .L52+16
 1398 0022 4FF0FF33 		mov	r3, #-1
 1399 0026 0122     		movs	r2, #1
 1400 0028 0DF10301 		add	r1, sp, #3
 1401 002c 2846     		mov	r0, r5
 1402 002e FFF7FEFF 		bl	HAL_SPI_Transmit
 1403              	.LVL150:
 464:Core/Src/TMAG5170.c **** 
 465:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, buff[0], 1, HAL_MAX_DELAY);
 1404              		.loc 1 465 3 view .LVU362
 1405              		.loc 1 465 31 is_stmt 0 view .LVU363
 1406 0032 9DF80460 		ldrb	r6, [sp, #4]	@ zero_extendqisi2
 1407              		.loc 1 465 3 view .LVU364
 1408 0036 4FF0FF33 		mov	r3, #-1
 1409 003a 0122     		movs	r2, #1
 1410 003c 3146     		mov	r1, r6
 1411 003e 2846     		mov	r0, r5
 1412 0040 FFF7FEFF 		bl	HAL_SPI_Receive
 1413              	.LVL151:
 466:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, buff[1], 1, HAL_MAX_DELAY);
 1414              		.loc 1 466 3 is_stmt 1 view .LVU365
 1415              		.loc 1 466 31 is_stmt 0 view .LVU366
 1416 0044 9DF80540 		ldrb	r4, [sp, #5]	@ zero_extendqisi2
 1417              		.loc 1 466 3 view .LVU367
 1418 0048 4FF0FF33 		mov	r3, #-1
 1419 004c 0122     		movs	r2, #1
 1420 004e 2146     		mov	r1, r4
 1421 0050 2846     		mov	r0, r5
 1422 0052 FFF7FEFF 		bl	HAL_SPI_Receive
 1423              	.LVL152:
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 34


 467:Core/Src/TMAG5170.c **** 
 468:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1424              		.loc 1 468 3 is_stmt 1 view .LVU368
 1425 0056 0122     		movs	r2, #1
 1426 0058 1021     		movs	r1, #16
 1427 005a 3846     		mov	r0, r7
 1428 005c FFF7FEFF 		bl	HAL_GPIO_WritePin
 1429              	.LVL153:
 469:Core/Src/TMAG5170.c **** 
 470:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, buff[1], strlen(buff[1]), HAL_MAX_DELAY);
 1430              		.loc 1 470 3 view .LVU369
 1431              		.loc 1 470 39 is_stmt 0 view .LVU370
 1432 0060 2046     		mov	r0, r4
 1433 0062 FFF7FEFF 		bl	strlen
 1434              	.LVL154:
 1435              		.loc 1 470 3 view .LVU371
 1436 0066 4FF0FF33 		mov	r3, #-1
 1437 006a 82B2     		uxth	r2, r0
 1438 006c 2146     		mov	r1, r4
 1439 006e 1348     		ldr	r0, .L52+20
 1440 0070 FFF7FEFF 		bl	HAL_UART_Transmit
 1441              	.LVL155:
 471:Core/Src/TMAG5170.c **** 
 472:Core/Src/TMAG5170.c **** 
 473:Core/Src/TMAG5170.c ****   TADCt = ((uint16_t)buff[0] << 4)|buff[1]>>4;
 1442              		.loc 1 473 3 is_stmt 1 view .LVU372
 1443              		.loc 1 473 35 is_stmt 0 view .LVU373
 1444 0074 2009     		lsrs	r0, r4, #4
 1445              	.LVL156:
 474:Core/Src/TMAG5170.c **** 
 475:Core/Src/TMAG5170.c ****   temp = 25.0 + ((TADCt + 17522.0)/60.0);
 1446              		.loc 1 475 3 is_stmt 1 view .LVU374
 1447              		.loc 1 475 25 is_stmt 0 view .LVU375
 1448 0076 40EA0610 		orr	r0, r0, r6, lsl #4
 1449              	.LVL157:
 1450              		.loc 1 475 25 view .LVU376
 1451 007a FFF7FEFF 		bl	__aeabi_i2d
 1452              	.LVL158:
 1453              		.loc 1 475 25 view .LVU377
 1454 007e 0AA3     		adr	r3, .L52
 1455 0080 D3E90023 		ldrd	r2, [r3]
 1456 0084 FFF7FEFF 		bl	__aeabi_dadd
 1457              	.LVL159:
 1458              		.loc 1 475 35 view .LVU378
 1459 0088 0022     		movs	r2, #0
 1460 008a 0D4B     		ldr	r3, .L52+24
 1461 008c FFF7FEFF 		bl	__aeabi_ddiv
 1462              	.LVL160:
 1463              		.loc 1 475 15 view .LVU379
 1464 0090 0022     		movs	r2, #0
 1465 0092 0C4B     		ldr	r3, .L52+28
 1466 0094 FFF7FEFF 		bl	__aeabi_dadd
 1467              	.LVL161:
 1468              		.loc 1 475 8 view .LVU380
 1469 0098 FFF7FEFF 		bl	__aeabi_d2f
 1470              	.LVL162:
 476:Core/Src/TMAG5170.c **** 
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 35


 477:Core/Src/TMAG5170.c ****   return temp;
 1471              		.loc 1 477 3 is_stmt 1 view .LVU381
 478:Core/Src/TMAG5170.c **** 
 479:Core/Src/TMAG5170.c ****   
 480:Core/Src/TMAG5170.c **** 
 481:Core/Src/TMAG5170.c ****   //HAL_UART_Transmit(&huart2, TADCt, strlen(TADCt), HAL_MAX_DELAY);
 482:Core/Src/TMAG5170.c **** 
 483:Core/Src/TMAG5170.c ****   //UART_buff_length = sprintf(UART_buff, "%f\r\n", temperature);
 484:Core/Src/TMAG5170.c ****   //HAL_UART_Transmit(&huart2, UART_buff, UART_buff_length, HAL_MAX_DELAY );
 485:Core/Src/TMAG5170.c **** 
 486:Core/Src/TMAG5170.c ****   // char buffff[100];
 487:Core/Src/TMAG5170.c ****   // gcvt(temp, 4, buffff);
 488:Core/Src/TMAG5170.c ****   // HAL_UART_Transmit(&huart2, (uint8_t)buffff, strlen(buffff), HAL_MAX_DELAY );
 489:Core/Src/TMAG5170.c **** 
 490:Core/Src/TMAG5170.c **** }
 1472              		.loc 1 490 1 is_stmt 0 view .LVU382
 1473 009c 00EE100A 		vmov	s0, r0
 1474 00a0 03B0     		add	sp, sp, #12
 1475              	.LCFI33:
 1476              		.cfi_def_cfa_offset 20
 1477              		@ sp needed
 1478 00a2 F0BD     		pop	{r4, r5, r6, r7, pc}
 1479              	.LVL163:
 1480              	.L53:
 1481              		.loc 1 490 1 view .LVU383
 1482 00a4 AFF30080 		.align	3
 1483              	.L52:
 1484 00a8 00000000 		.word	0
 1485 00ac 801CD140 		.word	1087446144
 1486 00b0 00040048 		.word	1207960576
 1487 00b4 00000000 		.word	.LANCHOR1
 1488 00b8 00000000 		.word	hspi1
 1489 00bc 00000000 		.word	huart2
 1490 00c0 00004E40 		.word	1078853632
 1491 00c4 00003940 		.word	1077477376
 1492              		.cfi_endproc
 1493              	.LFE146:
 1495              		.section	.text.GetMagnitude,"ax",%progbits
 1496              		.align	1
 1497              		.global	GetMagnitude
 1498              		.syntax unified
 1499              		.thumb
 1500              		.thumb_func
 1502              	GetMagnitude:
 1503              	.LFB147:
 491:Core/Src/TMAG5170.c **** 
 492:Core/Src/TMAG5170.c **** void GetMagnitude(void)
 493:Core/Src/TMAG5170.c **** {
 1504              		.loc 1 493 1 is_stmt 1 view -0
 1505              		.cfi_startproc
 1506              		@ args = 0, pretend = 0, frame = 16
 1507              		@ frame_needed = 0, uses_anonymous_args = 0
 1508 0000 30B5     		push	{r4, r5, lr}
 1509              	.LCFI34:
 1510              		.cfi_def_cfa_offset 12
 1511              		.cfi_offset 4, -12
 1512              		.cfi_offset 5, -8
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 36


 1513              		.cfi_offset 14, -4
 1514 0002 85B0     		sub	sp, sp, #20
 1515              	.LCFI35:
 1516              		.cfi_def_cfa_offset 32
 494:Core/Src/TMAG5170.c ****   // Received data
 495:Core/Src/TMAG5170.c ****   uint8_t RxData[2];
 1517              		.loc 1 495 3 view .LVU385
 496:Core/Src/TMAG5170.c ****   uint16_t data_reg;
 1518              		.loc 1 496 3 view .LVU386
 497:Core/Src/TMAG5170.c **** 
 498:Core/Src/TMAG5170.c ****   // Magnitude
 499:Core/Src/TMAG5170.c ****   uint16_t M;
 1519              		.loc 1 499 3 view .LVU387
 500:Core/Src/TMAG5170.c **** 
 501:Core/Src/TMAG5170.c **** 
 502:Core/Src/TMAG5170.c ****   // Send address
 503:Core/Src/TMAG5170.c ****   register_address = TMAG5170_MAGNITUDE_RESULT_REG;
 1520              		.loc 1 503 3 view .LVU388
 1521              		.loc 1 503 20 is_stmt 0 view .LVU389
 1522 0004 1423     		movs	r3, #20
 1523 0006 1D4A     		ldr	r2, .L56
 1524 0008 1370     		strb	r3, [r2]
 504:Core/Src/TMAG5170.c ****   uint8_t FirstFrame = register_address;
 1525              		.loc 1 504 3 is_stmt 1 view .LVU390
 1526              		.loc 1 504 11 is_stmt 0 view .LVU391
 1527 000a 8DF80B30 		strb	r3, [sp, #11]
 505:Core/Src/TMAG5170.c ****   FirstFrame |= 0b1 << 7;
 1528              		.loc 1 505 3 is_stmt 1 view .LVU392
 1529              		.loc 1 505 14 is_stmt 0 view .LVU393
 1530 000e 9423     		movs	r3, #148
 1531 0010 8DF80B30 		strb	r3, [sp, #11]
 506:Core/Src/TMAG5170.c **** 
 507:Core/Src/TMAG5170.c ****   // CS LOW
 508:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 0);
 1532              		.loc 1 508 3 is_stmt 1 view .LVU394
 1533 0014 1A4C     		ldr	r4, .L56+4
 1534 0016 0022     		movs	r2, #0
 1535 0018 1021     		movs	r1, #16
 1536 001a 2046     		mov	r0, r4
 1537 001c FFF7FEFF 		bl	HAL_GPIO_WritePin
 1538              	.LVL164:
 509:Core/Src/TMAG5170.c ****   // Transmit address
 510:Core/Src/TMAG5170.c ****   HAL_SPI_Transmit(&hspi1, &FirstFrame, 1, HAL_MAX_DELAY);
 1539              		.loc 1 510 3 view .LVU395
 1540 0020 184D     		ldr	r5, .L56+8
 1541 0022 4FF0FF33 		mov	r3, #-1
 1542 0026 0122     		movs	r2, #1
 1543 0028 0DF10B01 		add	r1, sp, #11
 1544 002c 2846     		mov	r0, r5
 1545 002e FFF7FEFF 		bl	HAL_SPI_Transmit
 1546              	.LVL165:
 511:Core/Src/TMAG5170.c ****   // Receive data
 512:Core/Src/TMAG5170.c ****   HAL_SPI_Receive(&hspi1, RxData, 2, HAL_MAX_DELAY);
 1547              		.loc 1 512 3 view .LVU396
 1548 0032 4FF0FF33 		mov	r3, #-1
 1549 0036 0222     		movs	r2, #2
 1550 0038 03A9     		add	r1, sp, #12
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 37


 1551 003a 2846     		mov	r0, r5
 1552 003c FFF7FEFF 		bl	HAL_SPI_Receive
 1553              	.LVL166:
 513:Core/Src/TMAG5170.c ****   // CS HIGH
 514:Core/Src/TMAG5170.c ****   HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, 1);
 1554              		.loc 1 514 3 view .LVU397
 1555 0040 0122     		movs	r2, #1
 1556 0042 1021     		movs	r1, #16
 1557 0044 2046     		mov	r0, r4
 1558 0046 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1559              	.LVL167:
 515:Core/Src/TMAG5170.c **** 
 516:Core/Src/TMAG5170.c ****   // uint8_t to uint16_t
 517:Core/Src/TMAG5170.c ****   data_reg = RxData[0];
 1560              		.loc 1 517 3 view .LVU398
 1561              		.loc 1 517 12 is_stmt 0 view .LVU399
 1562 004a 9DF80C30 		ldrb	r3, [sp, #12]	@ zero_extendqisi2
 1563              	.LVL168:
 518:Core/Src/TMAG5170.c ****   data_reg = data_reg << 8;
 1564              		.loc 1 518 3 is_stmt 1 view .LVU400
 519:Core/Src/TMAG5170.c ****   data_reg |= RxData[1];
 1565              		.loc 1 519 3 view .LVU401
 1566              		.loc 1 519 21 is_stmt 0 view .LVU402
 1567 004e 9DF80D20 		ldrb	r2, [sp, #13]	@ zero_extendqisi2
 1568              		.loc 1 519 12 view .LVU403
 1569 0052 42EA0322 		orr	r2, r2, r3, lsl #8
 1570              	.LVL169:
 520:Core/Src/TMAG5170.c **** 
 521:Core/Src/TMAG5170.c ****   // read Magnitude 13 LSB
 522:Core/Src/TMAG5170.c ****   uint16_t and = data_reg;
 1571              		.loc 1 522 3 is_stmt 1 view .LVU404
 523:Core/Src/TMAG5170.c ****   M = and & 0x1FFF;
 1572              		.loc 1 523 3 view .LVU405
 524:Core/Src/TMAG5170.c **** 
 525:Core/Src/TMAG5170.c **** 
 526:Core/Src/TMAG5170.c ****   char str[8];
 1573              		.loc 1 526 3 view .LVU406
 527:Core/Src/TMAG5170.c **** 
 528:Core/Src/TMAG5170.c ****   // converting to char
 529:Core/Src/TMAG5170.c ****   sprintf(str, "%d", M); 
 1574              		.loc 1 529 3 view .LVU407
 1575 0056 C2F30C02 		ubfx	r2, r2, #0, #13
 1576              	.LVL170:
 1577              		.loc 1 529 3 is_stmt 0 view .LVU408
 1578 005a 0B49     		ldr	r1, .L56+12
 1579 005c 6846     		mov	r0, sp
 1580 005e FFF7FEFF 		bl	sprintf
 1581              	.LVL171:
 530:Core/Src/TMAG5170.c **** 
 531:Core/Src/TMAG5170.c ****   // sending data to console
 532:Core/Src/TMAG5170.c ****   HAL_UART_Transmit(&huart2, str, strlen(str), HAL_MAX_DELAY);
 1582              		.loc 1 532 3 is_stmt 1 view .LVU409
 1583              		.loc 1 532 35 is_stmt 0 view .LVU410
 1584 0062 6846     		mov	r0, sp
 1585 0064 FFF7FEFF 		bl	strlen
 1586              	.LVL172:
 1587              		.loc 1 532 3 view .LVU411
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 38


 1588 0068 4FF0FF33 		mov	r3, #-1
 1589 006c 82B2     		uxth	r2, r0
 1590 006e 6946     		mov	r1, sp
 1591 0070 0648     		ldr	r0, .L56+16
 1592 0072 FFF7FEFF 		bl	HAL_UART_Transmit
 1593              	.LVL173:
 533:Core/Src/TMAG5170.c **** }...
 1594              		.loc 1 533 1 view .LVU412
 1595 0076 05B0     		add	sp, sp, #20
 1596              	.LCFI36:
 1597              		.cfi_def_cfa_offset 12
 1598              		@ sp needed
 1599 0078 30BD     		pop	{r4, r5, pc}
 1600              	.L57:
 1601 007a 00BF     		.align	2
 1602              	.L56:
 1603 007c 00000000 		.word	.LANCHOR1
 1604 0080 00040048 		.word	1207960576
 1605 0084 00000000 		.word	hspi1
 1606 0088 00000000 		.word	.LC0
 1607 008c 00000000 		.word	huart2
 1608              		.cfi_endproc
 1609              	.LFE147:
 1611              		.section	.bss.AlertConfigSettings,"aw",%nobits
 1612              		.align	2
 1613              		.set	.LANCHOR4,. + 0
 1616              	AlertConfigSettings:
 1617 0000 00000000 		.space	9
 1617      00000000 
 1617      00
 1618              		.section	.bss.DeviceConfigSettings,"aw",%nobits
 1619              		.align	2
 1620              		.set	.LANCHOR0,. + 0
 1623              	DeviceConfigSettings:
 1624 0000 00000000 		.space	6
 1624      0000
 1625              		.section	.bss.SensorConfigSettings,"aw",%nobits
 1626              		.align	2
 1627              		.set	.LANCHOR2,. + 0
 1630              	SensorConfigSettings:
 1631 0000 00000000 		.space	6
 1631      0000
 1632              		.section	.bss.SystemConfigSettings,"aw",%nobits
 1633              		.align	2
 1634              		.set	.LANCHOR3,. + 0
 1637              	SystemConfigSettings:
 1638 0000 00000000 		.space	7
 1638      000000
 1639              		.section	.bss.register_address,"aw",%nobits
 1640              		.set	.LANCHOR1,. + 0
 1643              	register_address:
 1644 0000 00       		.space	1
 1645              		.text
 1646              	.Letext0:
 1647              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1648              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1649              		.file 4 "Core/Inc/tmag5170.h"
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 39


 1650              		.file 5 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g491xx.h"
 1651              		.file 6 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 1652              		.file 7 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 1653              		.file 8 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 1654              		.file 9 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 1655              		.file 10 "Core/Inc/spi.h"
 1656              		.file 11 "Core/Inc/usart.h"
 1657              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_gpio.h"
 1658              		.file 13 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
 1659              		.file 14 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
 1660              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 40


DEFINED SYMBOLS
                            *ABS*:00000000 TMAG5170.c
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:20     .text.TransmitData:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:26     .text.TransmitData:00000000 TransmitData
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:101    .text.TransmitData:00000058 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:107    .text.TMAG5170_dev_conf_settings:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:113    .text.TMAG5170_dev_conf_settings:00000000 TMAG5170_dev_conf_settings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:207    .text.TMAG5170_dev_conf_settings:00000054 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:212    .text.TMAG5170_sens_conf_settings:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:218    .text.TMAG5170_sens_conf_settings:00000000 TMAG5170_sens_conf_settings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:325    .text.TMAG5170_sens_conf_settings:0000005c $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:331    .text.TMAG5170_sys_conf_settings:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:337    .text.TMAG5170_sys_conf_settings:00000000 TMAG5170_sys_conf_settings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:452    .text.TMAG5170_sys_conf_settings:00000068 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:458    .text.TMAG5170_al_conf_settings:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:464    .text.TMAG5170_al_conf_settings:00000000 TMAG5170_al_conf_settings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:595    .text.TMAG5170_al_conf_settings:0000007c $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:601    .text.DisableCRC:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:607    .text.DisableCRC:00000000 DisableCRC
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:667    .text.DisableCRC:00000044 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:673    .text.ReadRegister:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:679    .text.ReadRegister:00000000 ReadRegister
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:747    .text.ReadRegister:00000058 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:754    .text.ReadRegister1:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:760    .text.ReadRegister1:00000000 ReadRegister1
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:828    .text.ReadRegister1:00000058 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:835    .rodata.GetmT.str1.4:00000000 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:845    .text.GetmT:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:851    .text.GetmT:00000000 GetmT
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1066   .text.GetmT:00000124 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1080   .text.ReadData:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1086   .text.ReadData:00000000 ReadData
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1189   .text.ReadData:0000007c $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1196   .text.GetAngle:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1202   .text.GetAngle:00000000 GetAngle
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1337   .text.GetAngle:000000a8 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1350   .text.GetTemp:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1356   .text.GetTemp:00000000 GetTemp
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1484   .text.GetTemp:000000a8 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1496   .text.GetMagnitude:00000000 $t
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1502   .text.GetMagnitude:00000000 GetMagnitude
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1603   .text.GetMagnitude:0000007c $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1612   .bss.AlertConfigSettings:00000000 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1616   .bss.AlertConfigSettings:00000000 AlertConfigSettings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1619   .bss.DeviceConfigSettings:00000000 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1623   .bss.DeviceConfigSettings:00000000 DeviceConfigSettings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1626   .bss.SensorConfigSettings:00000000 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1630   .bss.SensorConfigSettings:00000000 SensorConfigSettings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1633   .bss.SystemConfigSettings:00000000 $d
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1637   .bss.SystemConfigSettings:00000000 SystemConfigSettings
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1643   .bss.register_address:00000000 register_address
C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s:1644   .bss.register_address:00000000 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_Transmit
hspi1
ARM GAS  C:\Users\jakub\AppData\Local\Temp\cct1bJHG.s 			page 41


HAL_SPI_Receive
sprintf
strlen
HAL_UART_Transmit
huart2
HAL_Delay
__aeabi_i2d
__aeabi_dadd
__aeabi_ddiv
__aeabi_d2f
